# libtiff: multiple UBSAN crashes

## POC URL
https://github.com/asarubbo/poc/tree/master/00113-libtiff-outside-float
https://github.com/asarubbo/poc/tree/master/00114-libtiff-outside-float-tif_dirread
https://github.com/asarubbo/poc/tree/master/00115-libtiff-fpe-tif_dirread
https://github.com/asarubbo/poc/tree/master/00117-libtiff-outside-short-tif_dirwrite
https://github.com/asarubbo/poc/tree/master/00118-libtiff-outside-unsigned-char-tif_dirwrite
https://github.com/asarubbo/poc/tree/master/00119-libtiff-shift-long-tif_jpeg
https://github.com/asarubbo/poc/tree/master/00121-libtiff-signintoverflow-tif_read

## Compilation Environment
- libtiff version 4.0.7 (vulnerable version)
- System with undefined behavior sanitizer (UBSAN) enabled

## Run Command
```
tiffcp -i $FILE /tmp/foo
```

Replace `$FILE` with the path to one of the provided PoC files.

## Expected Output
Depending on which PoC file is used, you should see one of the following UBSAN runtime errors:
1. `runtime error: value 5.84589e+199 is outside the range of representable values of type 'float'`
2. `runtime error: value -4.779e+161 is outside the range of representable values of type 'float'`
3. `runtime error: division by zero` (two instances)
4. `runtime error: value 65280 is outside the range of representable values of type 'short'`
5. `runtime error: value -115 is outside the range of representable values of type 'unsigned char'`
6. `runtime error: shift exponent 136 is too large for 64-bit type 'long'`
7. `runtime error: signed integer overflow: 9223372036452122640 + 85899345928 cannot be represented in type 'long'`

These crashes demonstrate various undefined behavior vulnerabilities in libtiff 4.0.7 that were fixed in later versions.