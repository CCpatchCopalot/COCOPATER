# README


## Run Command
./h5dump-shared $file

## Expected Output
vuln/H5FL_blk_malloc-heap-buffer-overflow
==22434==AddressSanitizer: libc interceptors initialized
|| `[0x10007fff8000, 0x7fffffffffff]` || HighMem    ||
|| `[0x02008fff7000, 0x10007fff7fff]` || HighShadow ||
|| `[0x00008fff7000, 0x02008fff6fff]` || ShadowGap  ||
|| `[0x00007fff8000, 0x00008fff6fff]` || LowShadow  ||
|| `[0x000000000000, 0x00007fff7fff]` || LowMem     ||
MemToShadow(shadow): 0x00008fff7000 0x000091ff6dff 0x004091ff6e00 0x02008fff6fff
redzone=16
max_redzone=2048
quarantine_size_mb=256M
thread_local_quarantine_size_kb=1024K
malloc_context_size=30
SHADOW_SCALE: 3
SHADOW_GRANULARITY: 8
SHADOW_OFFSET: 0x7fff8000
==22434==Installed the sigaction for signal 11
==22434==Installed the sigaction for signal 7
==22434==Installed the sigaction for signal 8
==22434==T0: stack [0x7ffe4b043000,0x7ffe4b843000) size 0x800000; local=0x7ffe4b841b78
==22434==AddressSanitizer Init done
=================================================================
==22434==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000004c50 at pc 0x7fbfd8cf2986 bp 0x7ffe4b83eff0 sp 0x7ffe4b83efe8
WRITE of size 8 at 0x602000004c50 thread T0
    #0 0x7fbfd8cf2985 in H5FL_blk_malloc /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5FL.c:891:15
    #1 0x7fbfd86782d7 in H5HL_prefix_load /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5HLcache.c:328:44
    #2 0x7fbfd8cde728 in H5C_load_entry /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5C.c:7950:25
    #3 0x7fbfd8cde728 in H5C_protect /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5C.c:3568
    #4 0x7fbfd83768ad in H5AC_protect /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5AC.c:1250:13
    #5 0x7fbfd86769cd in H5HL_heapsize /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5HL.c:1207:39
    #6 0x7fbfd85ce924 in H5G__stab_bh_size /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gstab.c:685:8
    #7 0x7fbfd85c5179 in H5O_group_bh_info /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Goh.c:400:12
    #8 0x7fbfd869ee48 in H5O_get_info /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5O.c:2879:16
    #9 0x7fbfd85a6c1c in H5G_loc_info_cb /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gloc.c:699:8
    #10 0x7fbfd85df514 in H5G_traverse_real /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gtraverse.c:638:16
    #11 0x7fbfd85dc24a in H5G_traverse /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gtraverse.c:858:8
    #12 0x7fbfd85a6951 in H5G_loc_info /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gloc.c:744:8
    #13 0x7fbfd869d37a in H5Oget_info_by_name /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5O.c:659:8
    #14 0x7fbfd924ecfb in traverse_cb /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/lib/h5trav.c:204:12
    #15 0x7fbfd859ecf7 in H5G_visit_cb /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gint.c:937:17
    #16 0x7fbfd85b43f2 in H5G__node_iterate /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gnode.c:1004:25
    #17 0x7fbfd8385bc4 in H5B_iterate_helper /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5B.c:1173:25
    #18 0x7fbfd8385602 in H5B_iterate /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5B.c:1218:21
    #19 0x7fbfd85cd785 in H5G__stab_iterate /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gstab.c:563:25
    #20 0x7fbfd85be37a in H5G__obj_iterate /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gobj.c:705:25
    #21 0x7fbfd859dd32 in H5G_visit /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5Gint.c:1172:21
    #22 0x7fbfd8d2690c in H5Lvisit_by_name /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5L.c:1376:21
    #23 0x7fbfd9249e44 in traverse /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/lib/h5trav.c:289:16
    #24 0x7fbfd924dba2 in h5trav_visit /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/lib/h5trav.c:1061:8
    #25 0x7fbfd92461c3 in init_objs /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/lib/h5tools_utils.c:577:12
    #26 0x5165a5 in table_list_add /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/h5dump/h5dump.c:404:8
    #27 0x519992 in main /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/tools/h5dump/h5dump.c:1475:12
    #28 0x7fbfd71eab96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)
    #29 0x41dfa9 in _start (/home/pwd/fuzz/fuzz-hdf5/pwd-build/installed/bin/h5dump-shared+0x41dfa9)

0x602000004c57 is located 0 bytes to the right of 7-byte region [0x602000004c50,0x602000004c57)
allocated by thread T0 here:
    #0 0x4dde60 in malloc /home/pwd/llvm_dev/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88
    #1 0x7fbfd8d36758 in H5MM_malloc /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5MM.c:64:21

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/pwd/fuzz/fuzz-hdf5/hdf5-1.8.20/src/H5FL.c:891:15 in H5FL_blk_malloc
Shadow bytes around the buggy address:
  0x0c047fff8930: fa fa 00 00 fa fa 00 00 fa fa 00 00 fa fa 00 00
  0x0c047fff8940: fa fa 00 00 fa fa 02 fa fa fa 00 fa fa fa 00 00
  0x0c047fff8950: fa fa 00 00 fa fa 00 00 fa fa fd fa fa fa 00 00
  0x0c047fff8960: fa fa 00 00 fa fa 04 fa fa fa 05 fa fa fa 05 fa
  0x0c047fff8970: fa fa 04 fa fa fa 00 05 fa fa 00 00 fa fa 00 05
=>0x0c047fff8980: fa fa 00 00 fa fa 00 00 fa fa[07]fa fa fa fa fa
  0x0c047fff8990: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff89a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff89b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff89c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff89d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==22434==ABORTING