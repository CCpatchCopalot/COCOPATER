# Stack Buffer Overflow in GPAC's AV1 Parser

## POC URL
https://github.com/Clingto/POC/blob/master/gpac-MP4Box/gpac-00dfc93-crashes/POC-new-av1_parse_tile_group

## Compilation Environment
- OS: Ubuntu 16.04.6 LTS
- Architecture: x86_64
- Compiler: gcc 5.4.0
- GPAC Version: Latest master (commit 00dfc93)

## Compile Command
```bash
CC="gcc -fsanitize=address -g" CXX="g++ -fsanitize=address -g" ./configure --static-mp4box
make
```

## Run Command
```bash
MP4Box -diso -out /dev/null POC-new-av1_parse_tile_group
```

## Expected Output
```
=================================================================
==25824==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffff8278 at pc 0x00000082ff06 bp 0x7ffffffef7a0 sp 0x7ffffffef790
WRITE of size 4 at 0x7fffffff8278 thread T0
    #0 0x82ff05 in av1_parse_tile_group media_tools/av_parsers.c:3845
    #1 0x840f2f in av1_parse_frame media_tools/av_parsers.c:3882
    #2 0x840f2f in gf_media_aom_av1_parse_obu media_tools/av_parsers.c:3969
    #3 0x69909c in av1c_Read isomedia/avc_ext.c:2651
    #4 0x6c5114 in gf_isom_box_read isomedia/box_funcs.c:1528
    #5 0x6c5114 in gf_isom_box_parse_ex isomedia/box_funcs.c:208
    #6 0x6c5974 in gf_isom_parse_root_box isomedia/box_funcs.c:42
    #7 0x6da6a0 in gf_isom_parse_movie_boxes isomedia/isom_intern.c:206
    #8 0x6dd2f3 in gf_isom_parse_movie_boxes isomedia/isom_intern.c:194
    #9 0x6dd2f3 in gf_isom_open_file isomedia/isom_intern.c:615
    #10 0x42f88a in mp4boxMain applications/mp4box/main.c:4767
    #11 0x7ffff638082f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f)
    #12 0x41e228 in _start

SUMMARY: AddressSanitizer: stack-buffer-overflow media_tools/av_parsers.c:3845 in av1_parse_tile_group
==25824==ABORTING
```

## Notes
- This bug was found using a custom fuzzer based on AFL
- The issue still exists in GPAC versions 0.8.0 (commit 4c19ae5) and 0.9.0 (commit 1de1f8d)
- The vulnerability occurs in the AV1 tile group parsing functionality
