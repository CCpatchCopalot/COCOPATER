# Memory Leak POC for GPAC MP4Box

## POC URL
https://github.com/Clingto/POC/blob/master/gpac-MP4Box/gpac-00dfc93-crashes/POC-new-memory-leak

## Compilation Environment
- OS: Ubuntu 16.04.6 LTS (x64)
- Compiler: gcc 5.4.0
- GPAC version: Latest master (commit 00dfc93)
- Compile Command:
```
CC="gcc -fsanitize=address -g" CXX="g++ -fsanitize=address -g" ./configure --static-mp4box
make
```

## Run Command
```
MP4Box -diso -out /dev/null POC-new-memory-leak
```

## Expected Output
```
[iso file] Box "metx" size 15 (start 89) invalid (read 25)
[iso file] Box "abst" size 24 (start 0) invalid (read 104)
[iso file] Incomplete box abst - start 0 size 24
[iso file] Incomplete file while reading for dump - aborting parsing
[iso file] Box "metx" size 15 (start 89) invalid (read 25)
[iso file] Box "abst" size 24 (start 0) invalid (read 104)
Truncated file - missing 24 bytes

==26041==ERROR: LeakSanitizer: detected memory leaks
Direct leak of 224 byte(s) in 2 object(s) allocated from:
    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)
    #1 0xaefada in metx_New isomedia/box_code_base.c:8367

Direct leak of 8 byte(s) in 2 object(s) allocated from:
    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)
    #1 0x792106 in abst_Read isomedia/box_code_adobe.c:95
    #2 0xb62c63 (/bin/MP4Box+0xb62c63)

Indirect leak of 32 byte(s) in 2 object(s) allocated from:
    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)
    #1 0x46c27d in gf_list_new utils/list.c:602

Indirect leak of 16 byte(s) in 4 object(s) allocated from:
    #0 0x7ffff6f02602 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98602)
    #1 0x7ffff63eb489 in __strdup (/lib/x86_64-linux-gnu/libc.so.6+0x8b489)

SUMMARY: AddressSanitizer: 280 byte(s) leaked in 10 allocation(s).
```