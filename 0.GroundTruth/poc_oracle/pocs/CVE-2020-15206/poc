#include "tensorflow/cc/saved_model/loader.h"
#include "tensorflow/cc/saved_model/constants.h"
#include "tensorflow/cc/saved_model/tag_constants.h"

#include <fstream>
using namespace tensorflow;
int main(){
        const string export_dir = "/home/xxx/Playground/saved_model/intact"; // original pb file --> Status.ok() == true
        const string export_dir2 = "/home/xxx/Playground/saved_model/test"; // modified pb file --> Status.ok() == false
        const string export_dir3 = "/home/xxx/Playground/saved_model/crashes"; // modified pb file --> crash
        SavedModelBundle bundle;
        SessionOptions session_options;
        RunOptions run_options;
	    std::cout<<"hello"<<std::endl;
        if(LoadSavedModel(session_options, run_options, export_dir, {kSavedModelTagServe}, &bundle).ok()){
		std::cout<<"Load Successful!"<<std::endl;
	}
	std::cout<<"-------------------------"<<std::endl;
	if(LoadSavedModel(session_options, run_options, export_dir2, {kSavedModelTagServe}, &bundle).ok()){
		std::cout<<"Load Successful!"<<std::endl;
	}
	std::cout<<"-------------------------"<<std::endl;
	if(LoadSavedModel(session_options, run_options, export_dir3, {kSavedModelTagServe}, &bundle).ok()){
		std::cout<<"Load Successful!"<<std::endl;
	}
	std::cout<<"-------------------------"<<std::endl;

    }