# Heap Buffer Overflow in GhostScript (CVE-2019-14869)

## POC URL
Bug report and POC file can be found at: https://bugs.ghostscript.com/show_bug.cgi?id=701787

## Compilation Environment
- OS: Ubuntu 18.04 64-bit
- GhostScript version: master branch (commit prior to 4f73e8b4d578e69a17f452fa60d2130c5faaefd6)
- Compiler: GCC with AddressSanitizer (ASan) enabled

## Run Command
```
gs -dNOPAUSE -r345 -dFitPage -sPAPERSIZE=legal -sOutputFile=tmp -sDEVICE=cdj970 heap_overflow_poc.pdf
```

## Expected Output
When running the POC with a vulnerable version of GhostScript, you should see a heap buffer overflow reported by AddressSanitizer. The crash occurs in `mem_true32_fill_rectangle` at `base/gdevm32.c:102` when trying to write beyond the bounds of an allocated buffer.

The vulnerability is caused by incorrect band height calculation when the device width changes during processing, leading to a buffer overflow when filling the page.

## Fix
The issue was fixed in commit 4f73e8b4d578e69a17f452fa60d2130c5faaefd6 which properly handles device width changes during processing.