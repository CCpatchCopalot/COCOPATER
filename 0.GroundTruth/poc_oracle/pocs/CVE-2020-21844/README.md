# LibreDWG NULL Pointer Dereference Vulnerability

## POC URL
https://github.com/linhlhq/research/blob/master/PoCs/libreDWG_4c26d37/id:000000%2Csig:06%2Csrc:000009%2Cop:flip1%2Cpos:27641

## Compilation Environment
- Ubuntu Linux
- AddressSanitizer (ASAN) enabled build
- libredwg commit 4c26d37

## Run Command
```
./dwgbmp <path_to_poc_file>
```

## Expected Output
=================================================================
==32738==ERROR: AddressSanitizer: memcpy-param-overlap: memory ranges [0x62c000008200,0x62c00000f600) and [0x62c0000067a0, 0x62c00000dba0) overlap
    #0 0x7f52a17f7425  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79425)
    #1 0x55cd4d5ce7b6 in memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34
    #2 0x55cd4d5ce7b6 in read_2004_compressed_section ../../src/decode.c:2417
    #3 0x55cd4db91900 in read_2004_section_header ../../src/decode.c:2580
    #4 0x55cd4db91900 in decode_R2004 ../../src/decode.c:3350
    #5 0x55cd4dba408d in dwg_decode ../../src/decode.c:246
    #6 0x55cd4d536fae in dwg_read_file ../../src/dwg.c:211
    #7 0x55cd4d5359d0 in get_bmp ../../programs/dwgbmp.c:111
    #8 0x55cd4d535066 in main ../../programs/dwgbmp.c:280
    #9 0x7f52a1010b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)
    #10 0x55cd4d5356c9 in _start (/home/user/linhlhq/libredwg/asan_build/programs/dwgbmp+0x28f6c9)

0x62c000008200 is located 0 bytes inside of 29696-byte region [0x62c000008200,0x62c00000f600)
allocated by thread T0 here:
    #0 0x7f52a185cd38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)
    #1 0x55cd4d5cdf25 in read_2004_compressed_section ../../src/decode.c:2321
    #2 0x55cd4e0784b2  (/home/user/linhlhq/libredwg/asan_build/programs/dwgbmp+0xdd24b2)

0x62c0000070c0 is located 0 bytes to the right of 28352-byte region [0x62c000000200,0x62c0000070c0)
allocated by thread T0 here:
    #0 0x7f52a185cd38 in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xded38)
    #1 0x55cd4d536f41 in dat_read_file ../../src/dwg.c:74
    #2 0x55cd4d536f41 in dwg_read_file ../../src/dwg.c:204

SUMMARY: AddressSanitizer: memcpy-param-overlap (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79425)
==32738==ABORTING