# Heap Buffer Overflow in box_code_adobe.c

## POC URL
https://github.com/gpac/gpac/issues/1564

## Compilation Environment
- Ubuntu x86_64
- gcc (Ubuntu 5.5.0-12ubuntu1)
- MP4Box (latest master 2aa266)
- Configured with:
  ```
  CFLAGS="-g -fsanitize=address"
  LDFLAGS="-fsanitize-address -ldl"
  ./configure --static-mp4box
  ```

## Run Command
```
./bin/gcc/MP4Box -diso -out /dev/null heap-overflow-abst_box_read-box_code_adobe-109.zip
```

## Expected Output
```
=================================================================
==18613==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000e11c at pc 0x7f33b3f553d5 bp 0x7ffd678545b0 sp 0x7ffd67853d58
READ of size 13 at 0x60200000e11c thread T0
    #0 0x7f33b3f553d4 in strdup (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x623d4)
    #1 0x559646e8d0b7 in abst_box_read isomedia/box_code_adobe.c:109
    #2 0x559646cffd84 in gf_isom_box_read isomedia/box_funcs.c:1681
    #3 0x559646cffd84 in gf_isom_box_parse_ex isomedia/box_funcs.c:259
    #4 0x559646d01871 in gf_isom_parse_root_box isomedia/box_funcs.c:38
    #5 0x559646d30bf6 in gf_isom_parse_movie_boxes isomedia/isom_intern.c:259
    #6 0x559646d3a6c2 in gf_isom_parse_movie_boxes isomedia/isom_intern.c:247
    #7 0x559646d3a6c2 in gf_isom_open_file isomedia/isom_intern.c:740
    #8 0x559646897b30 in mp4boxMain /home/seviezhou/gpac/applications/mp4box/main.c:5331
    #9 0x7f33b2f1fb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)
    #10 0x55964685e179 in _start (/home/seviezhou/gpac/bin/gcc/MP4Box+0x78179)

0x60200000e11c is located 0 bytes to the right of 12-byte region [0x60200000e110,0x60200000e11c)
allocated by thread T0 here:
    #0 0x7f33b3f8b612 in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x98612)
    #1 0x559646e895e3 in abst_box_read isomedia/box_code_adobe.c:97

SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 strdup
==18613==ABORTING
```