# CVE-2020-6018

## Prerequisites
A 64-bit Linux environment (e.g., Ubuntu 20.04) with a vulnerable version of SteamNetworkingSockets (v1.1.x).

CMake, a modern C++ compiler (g++ ≥ 9), and AddressSanitizer for detecting the overflow. 
clang.llvm.org

SteamNetworkingSockets library source (v1.1.0) cloned from GitHub:

bash
Copy
Edit
git clone https://github.com/ValveSoftware/GameNetworkingSockets.git
cd GameNetworkingSockets
git checkout v1.1.0
research.checkpoint.com

## Setup
Build the library with AddressSanitizer

bash
Copy
Edit
mkdir build && cd build
cmake -DCMAKE_BUILD_TYPE=Debug \
      -DCMAKE_CXX_FLAGS="-fsanitize=address -g" \
      ..
make -j$(nproc)
sudo make install
This instruments the library so that overflows are caught at runtime 
clang.llvm.org
.

Prepare a vulnerable server
Start any game server that uses SteamNetworkingSockets (e.g., a local CS:GO dedicated server) on port 27036. Alternatively, write a minimal listener using the library’s demo code.

Building the PoC
Place the provided steam_sockets_poc.cpp next to your build directory, then compile:

bash
Copy
Edit
g++ -std=c++17 steam_sockets_poc.cpp \
    -lsteamnetworkingsockets -lprotobuf -pthread \
    -fsanitize=address -g \
    -o steam_sockets_poc
This links against the instrumented library and enables AddressSanitizer.

## Running the PoC
./steam_sockets_poc 127.0.0.1:27036
The PoC connects to the specified server, waits for the handshake, then crafts an “unreliable segment” with:

msgNum = 1

offset = -0x180

size = 0x400

lastSegment = true

It reinterprets the connection handle to call the internal SNP_ReceiveUnreliableSegment, triggering the underflow and crash 
research.checkpoint.com
.

Watch the console: AddressSanitizer should report a heap‐buffer‐overflow/free error.