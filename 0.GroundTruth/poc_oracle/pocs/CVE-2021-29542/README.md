# Heap Buffer Overflow in TensorFlow's StringNGrams

## POC URL
https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4hrh-9vmp-2jgg

## Description
An attacker can cause a heap buffer overflow by passing crafted inputs to `tf.raw_ops.StringNGrams`. The vulnerability occurs when the implementation fails to consider corner cases where input would be split in such a way that the generated tokens should only contain padding elements.

## Compilation Environment
- Python 3.x
- Vulnerable TensorFlow versions (< 2.5.0, < 2.4.2, < 2.3.3, < 2.2.3, < 2.1.4)

## Run Command
```
python poc.py
```

## Expected Output
The program will trigger a heap buffer overflow when processing the specially crafted input through the `StringNGrams` operation. This may result in a crash or potentially exploitable memory corruption.

## Notes
This vulnerability has been patched in TensorFlow versions 2.5.0, 2.4.2, 2.3.3, 2.2.3 and 2.1.4. The vulnerability was reported by Yakun Zhang and Ying Wang of Baidu X-Team.