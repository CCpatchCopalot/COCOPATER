# Heap Buffer Overflow in tiffcrop

## POC URL
[GitLab Issue #497](https://gitlab.com/libtiff/libtiff/-/issues/497)

## Compilation Environment
- OS: Linux 5.15.0-52-generic
- Architecture: x86_64
- Compiler flags:
  ```
  CFLAGS="-g -fsanitize=address -fno-omit-frame-pointer"
  CXXFLAGS="-g -fsanitize=address -fno-omit-frame-pointer"
  ```
- Configure command:
  ```
  ./configure --prefix=$PWD/build_asan --disable-shared
  ```

## Run Command
```
./build_asan/bin/tiffcrop -E right -z 1,1,2048,2048:1,2049,2048,4097 -i -s poc /tmp/foo
```

## Expected Output
The program should crash with a heap-buffer-overflow error detected by AddressSanitizer, showing a stack trace pointing to `extractContigSamplesShifted24bits` in `tiffcrop.c:3609`. The output will include memory allocation details and shadow bytes information from ASan.

Example error snippet:
```
==145258==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fd349a8f380
WRITE of size 1 at 0x7fd349a8f380 thread T0
    #0 0x561ae8db5054 in extractContigSamplesShifted24bits /root/programs_latest/libtiff/tools/tiffcrop.c:3609
```