# Heap Buffer Overflow in extractContigSamplesBytes()

## POC URL
https://gitlab.com/libtiff/libtiff/-/issues/519

## Compilation Environment
- OS: Ubuntu 20.04.1
- Kernel: 5.15.0-56-generic
- GCC: 9.4.0
- LibTIFF Version: 4.5.0 (commit a63e18ca)

## Run Command
```
./tools/tiffcrop -E l -Z 12:50,12:99 -e divided -R 90 poc /dev/null
```

## Expected Output
```
TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 12336 (0x3030) encountered.
TIFFReadDirectory: Warning, Unknown field with tag 0 (0x0) encountered.
TIFFFetchNormalTag: Defined set_field_type of custom tag 12336 (Tag 12336) is TIFF_SETGET_UNDEFINED and thus tag is not read from file.
TIFFReadDirectory: Warning, BitsPerSample tag is missing, assuming 8 bits per sample.
TIFFAdvanceDirectory: Error fetching directory count.
OJPEGSetupDecode: Warning, Deprecated and troublesome old-style JPEG compression mode, please convert to new-style JPEG compression and notify vendor of writing software.
LibJpeg: Warning, Corrupt JPEG data: bad Huffman code.
==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x627000006160 at pc 0x7fa1008f3490 bp 0x7ffcb8bf9ab0 sp 0x7ffcb8bf9258
READ of size 1 at 0x627000006160 thread T0
    #0 0x7fa1008f348f in __interceptor_memcpy
    #1 0x7fa1007ecfe9 in _TIFFmemcpy
    #2 0x556b1b674244 in extractContigSamplesBytes
    #3 0x556b1b68bf83 in extractSeparateRegion
    #4 0x556b1b68ffd0 in processCropSelections
    #5 0x556b1b6720e9 in main
    #6 0x7fa1002b0082 in __libc_start_main
    #7 0x556b1b668b6d in _start
```

This demonstrates a heap buffer overflow vulnerability in the `extractContigSamplesBytes()` function of tiffcrop utility when processing a specially crafted TIFF file.