# GTKWave FST LEB128 varint Stack-based Buffer Overflow Vulnerabilities (CVE-2023-35702, CVE-2023-35703, CVE-2023-35704)

## POC URL
This proof-of-concept demonstrates multiple stack-based buffer overflow vulnerabilities in GTKWave's FST file parser (version 3.3.115). The vulnerabilities exist in the LEB128 varint parsing functionality and can lead to arbitrary code execution when a malicious .fst file is opened.

## Compilation Environment
- Python 3.x
- GTKWave 3.3.115 (vulnerable version)

## Run Command
1. Generate the malicious FST file:
```
python3 poc.py
```

2. Open the generated file with GTKWave:
```
gtkwave exploit.fst
```

Or use the fst2vcd converter:
```
fst2vcd exploit.fst
```

## Expected Output
When the malicious FST file is opened with the vulnerable GTKWave version (3.3.115), it should trigger one or more of the stack-based buffer overflows, potentially leading to:
- Application crash
- Arbitrary code execution (depending on exploitability)

The vulnerabilities are triggered in:
1. `fstReaderVarint32()` (CVE-2023-35702) - 5-byte buffer overflow
2. `fstReaderVarint64()` (CVE-2023-35703) - 16-byte buffer overflow
3. `fstReaderVarint32WithSkip()` (CVE-2023-35704) - 5-byte buffer overflow

Note: These vulnerabilities were fixed in GTKWave version 3.3.118.