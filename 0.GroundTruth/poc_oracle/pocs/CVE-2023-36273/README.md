# CVE-2023-36273

## POC URL
- https://github.com/LibreDWG/libredwg/issues/677#BUG1

## environment
ubuntu 20.04, GCC 9.4.0, libredwg latest commit 77a8562

## compile with

./autogen.sh && ./configure --disable-shared && make -j$(nproc)

## BUG1
/libredwg/programs/dwg2dxf /pocs/pocs/dwg2dxf/poc0.bit_calc_CRC
Reading DWG file /pocs/pocs/dwg2dxf/poc0.bit_calc_CRC

## crash
ERROR: Header CRC mismatch 0003 <=> 3C16
Warning:
@0x3d7 => start 0x3c5
ERROR: DWG_SENTINEL_R11_ENTITIES_BEGIN mismatch
ERROR: DWG_SENTINEL_R11_ENTITIES_END mismatch
....
AddressSanitizer:DEADLYSIGNAL
=================================================================
==78==ERROR: AddressSanitizer: SEGV on unknown address 0x62100a3d71b3 (pc 0x563f38494cff bp 0x7ffd51ea1fa8 sp 0x7ffd51ea09e0 T0)
==78==The signal is caused by a READ memory access.
    #0 0x563f38494cfe in bit_calc_CRC /libredwg/src/bits.c:3456
    #1 0x563f38db6295 in decode_preR13_auxheader /libredwg/src/decode.c:6278
    #2 0x563f38e0736a in decode_preR13 /libredwg/src/decode_r11.c:786
    #3 0x563f38d8532a in dwg_decode /libredwg/src/decode.c:217
    #4 0x563f38472a67 in dwg_read_file /libredwg/src/dwg.c:261
    #5 0x563f38470c9c in main /libredwg/programs/dwg2dxf.c:261
    #6 0x7efdc3332082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #7 0x563f3847153d in _start (/libredwg/programs/dwg2dxf+0x23a53d)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /libredwg/src/bits.c:3456 in bit_calc_CRC
==78==ABORTING