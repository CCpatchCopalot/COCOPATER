{
    "0": "-        if (!esd) {\n\n+        if (!esd || !esd->decoderConfig) {\n\n-        if (!esd || !esd->decoderConfig) {\n\n+        if (!esd) {\n\n-            if (esd) {\n-                gf_odf_desc_del((GF_Descriptor *)esd);\n-            }\n\n-        if (esd && esd->decoderConfig) {\n\n+        if (esd) {\n\n-            if (esd) {\n-                gf_odf_desc_del((GF_Descriptor *)esd);\n-            }\n\n",
    "1": "+            if (esd) {\n+                gf_odf_desc_del((GF_Descriptor *)esd);\n+            }\n\n",
    "2": "-        if (esd) {\n\n+        if (esd && esd->decoderConfig) {\n\n",
    "3": "+            if (esd) {\n+                gf_odf_desc_del((GF_Descriptor *)esd);\n+            }\n\n",
    "4": "+                    if (gf_bs_get_size(bs) - gf_bs_get_position(bs) < 6) {\n+                        gf_isom_cenc_samp_aux_info_del(sai);\n+                        return GF_ISOM_VALID_FILE;\n+                    }\n\n",
    "5": "-                    if (gf_bs_get_size(bs) - gf_bs_get_position(bs) < 6) {\n-                        gf_isom_cenc_samp_aux_info_del(sai);\n-                        return GF_ISOM_VALID_FILE;\n-                    }\n\n",
    "6": "-    if (outOriginalFormat && sinf->original_format) {\n\n+    if (outOriginalFormat && sinf && sinf->original_format) {\n\n",
    "7": "-    if (outOriginalFormat && sinf && sinf->original_format) {\n\n+    if (outOriginalFormat && sinf->original_format) {\n\n",
    "8": "+    u8 count;\n\n",
    "9": "-    p->eventTypeCount = gf_bs_read_int(bs, 8);\n\n+    p->eventTypeCount = 0;\n+    count = gf_bs_read_int(bs, 8);\n+    if (count > ARRAY_LENGTH(p->eventType)) {\n+        return GF_CORRUPTED_DATA;\n+    }\n+    p->eventTypeCount = count;\n\n-    u8 count;\n\n",
    "10": "-    p->eventTypeCount = 0;\n-    count = gf_bs_read_int(bs, 8);\n-    if (count > ARRAY_LENGTH(p->eventType)) {\n-        return GF_CORRUPTED_DATA;\n-    }\n-    p->eventTypeCount = count;\n\n+    p->eventTypeCount = gf_bs_read_int(bs, 8);\n\n",
    "11": "-        if (GF_4CC(data[i+4], data[i+5], data[i+6], data[i+7]) == GF_ISOM_BOX_TYPE_ESDS) {\n\n+        if (GF_4CC((u32)data[i+4], (u8)data[i+5], (u8)data[i+6], (u8)data[i+7]) == GF_ISOM_BOX_TYPE_ESDS) {\n\n",
    "12": "+            if (!e) {\n+                gf_isom_box_add_for_dump_mode((GF_Box*)ptr, (GF_Box*)ptr->esd);\n+            }\n\n",
    "13": "-        if (GF_4CC((u32)data[i+4], (u8)data[i+5], (u8)data[i+6], (u8)data[i+7]) == GF_ISOM_BOX_TYPE_ESDS) {\n\n+        if (GF_4CC(data[i+4], data[i+5], data[i+6], data[i+7]) == GF_ISOM_BOX_TYPE_ESDS) {\n\n-            if (!e) {\n-                gf_isom_box_add_for_dump_mode((GF_Box*)ptr, (GF_Box*)ptr->esd);\n-            }\n\n"
}