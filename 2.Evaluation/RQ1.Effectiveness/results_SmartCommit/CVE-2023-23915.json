{
    "0": "+#ifndef CURL_DISABLE_HSTS\n+    Curl_hsts_cleanup(&share->hsts);\n+#endif\n\n",
    "1": "-#ifndef CURL_DISABLE_HSTS\n-    Curl_hsts_cleanup(&share->hsts);\n-#endif\n\n-#endif\n-            break;\n-        case CURL_LOCK_DATA_HSTS:\n-#ifndef CURL_DISABLE_HSTS\n-            if(!share->hsts) {\n-                share->hsts = Curl_hsts_init();\n-                if(!share->hsts) {\n-                    res = CURLSHE_NOMEM;\n-                }\n-            }\n-#else\n-            res = CURLSHE_NOT_BUILT_;\n\n-#endif\n-            break;\n-        case CURL_LOCK_DATA_HSTS:\n-#ifndef CURL_DISABLE_HSTS\n-            if(share->hsts) {\n-                Curl_hsts_cleanup(&share->hsts);\n-            }\n-#else\n-            res = CURLSHE_NOT_BUILT_;\n\n",
    "2": "+#ifndef CURL_DISABLE_HSTS\n+            if(data->share->hsts == data->hsts) {\n+                data->hsts = NULL;\n+            }\n+#endif\n+#ifdef USE_SSL\n\n",
    "3": "+#endif\n\n",
    "4": "+#ifndef CURL_DISABLE_HSTS\n+            if(data->share->hsts) {\n+                Curl_hsts_cleanup(&data->hsts);\n+                data->hsts = data->share->hsts;\n+            }\n+#endif\n+#ifdef USE_SSL\n\n",
    "5": "+#endif\n\n",
    "6": "-    case CURLOPT_HSTS:\n\n+    case CURLOPT_HSTS: {\n+        struct curl_slist *h;\n\n",
    "7": "+        if(argptr) {\n\n",
    "8": "-        if(argptr) {\n-            (void)Curl_hsts_loadfile(data, data->hsts, argptr);\n\n+            h = curl_slist_append(data->set.hstslist, argptr);\n+            if(!h) {\n+                curl_slist_free_all(data->set.hstslist);\n+                data->set.hstslist = NULL;\n+                return CURLE__OF_MEMORY;\n+            }\n+            data->set.hstslist = h;\n+        } else {\n+            curl_slist_free_all(data->set.hstslist);\n+            data->set.hstslist = NULL;\n+            if(!data->share || !data->share->hsts) {\n+                Curl_hsts_cleanup(&data->hsts);\n+            }\n\n-        if(argptr) {\n\n-            h = curl_slist_append(data->set.hstslist, argptr);\n-            if(!h) {\n-                curl_slist_free_all(data->set.hstslist);\n-                data->set.hstslist = NULL;\n-                return CURLE__OF_MEMORY;\n-            }\n-            data->set.hstslist = h;\n-        } else {\n-            curl_slist_free_all(data->set.hstslist);\n-            data->set.hstslist = NULL;\n-            if(!data->share || !data->share->hsts) {\n-                Curl_hsts_cleanup(&data->hsts);\n-            }\n\n+        if(argptr) {\n+            (void)Curl_hsts_loadfile(data, data->hsts, argptr);\n\n",
    "9": "+    }\n\n",
    "10": "-#ifndef CURL_DISABLE_HSTS\n-            if(data->share->hsts == data->hsts) {\n-                data->hsts = NULL;\n-            }\n-#endif\n-#ifdef USE_SSL\n\n-#ifndef CURL_DISABLE_HSTS\n-            if(data->share->hsts) {\n-                Curl_hsts_cleanup(&data->hsts);\n-                data->hsts = data->share->hsts;\n-            }\n-#endif\n-#ifdef USE_SSL\n\n",
    "11": "-#endif\n\n-#endif\n\n",
    "12": "-    case CURLOPT_HSTS: {\n-        struct curl_slist *h;\n\n+    case CURLOPT_HSTS:\n\n",
    "13": "-    }\n\n",
    "14": "+#endif\n+            break;\n+        case CURL_LOCK_DATA_HSTS:\n+#ifndef CURL_DISABLE_HSTS\n+            if(!share->hsts) {\n+                share->hsts = Curl_hsts_init();\n+                if(!share->hsts) {\n+                    res = CURLSHE_NOMEM;\n+                }\n+            }\n+#else\n+            res = CURLSHE_NOT_BUILT_;\n\n",
    "15": "+#endif\n+            break;\n+        case CURL_LOCK_DATA_HSTS:\n+#ifndef CURL_DISABLE_HSTS\n+            if(share->hsts) {\n+                Curl_hsts_cleanup(&share->hsts);\n+            }\n+#else\n+            res = CURLSHE_NOT_BUILT_;\n\n",
    "16": "+    Curl_hsts_loadfiles(data);\n\n",
    "17": "-    Curl_hsts_loadfiles(data);\n\n",
    "18": "+#ifndef CURL_DISABLE_HSTS\n+    if(!data->share || !data->share->hsts) {\n\n",
    "19": "+    }\n+    curl_slist_free_all(data->set.hstslist);\n+#endif\n\n",
    "20": "-#ifndef CURL_DISABLE_HSTS\n-    if(!data->share || !data->share->hsts) {\n\n-    }\n-    curl_slist_free_all(data->set.hstslist);\n-#endif\n\n"
}