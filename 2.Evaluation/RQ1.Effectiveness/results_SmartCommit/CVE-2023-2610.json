{
    "0": "-    char_u\t*tmpsub;\n\n",
    "1": "-    int\tlen;\n-    int\tprevlen;\n\n",
    "2": "-                prevlen = (int)STRLEN(reg_prev_sub);\n-                tmpsub = alloc(STRLEN(newsub) + prevlen);\n\n+                size_t\tprevsublen = STRLEN(reg_prev_sub);\n+                size_t newsublen = STRLEN(newsub);\n+                if (prevsublen > MAXCOL || newsublen > MAXCOL || newsublen + prevsublen > MAXCOL) {\n+                    emsg(_(e_resulting_text_too_long));\n+                    break;\n+                }\n+                char_u *tmpsub = alloc(newsublen + prevsublen);\n\n-                    len = (int)(p - newsub);\n-                    mch_memmove(tmpsub, newsub, (size_t)len);\n-                    mch_memmove(tmpsub + len, reg_prev_sub, (size_t)prevlen);\n\n+                    size_t prefixlen = p - newsub;\n+                    mch_memmove(tmpsub, newsub, prefixlen);\n+                    mch_memmove(tmpsub + prefixlen, reg_prev_sub, prevsublen);\n\n-                    STRCPY(tmpsub + len + prevlen, p + 1);\n\n+                    STRCPY(tmpsub + prefixlen + prevsublen, p + 1);\n\n-                    p = newsub + len + prevlen;\n\n+                    p = newsub + prefixlen + prevsublen;\n\n+    int\tlen;\n+    int\tprevlen;\n\n-                size_t\tprevsublen = STRLEN(reg_prev_sub);\n-                size_t newsublen = STRLEN(newsub);\n-                if (prevsublen > MAXCOL || newsublen > MAXCOL || newsublen + prevsublen > MAXCOL) {\n-                    emsg(_(e_resulting_text_too_long));\n-                    break;\n-                }\n-                char_u *tmpsub = alloc(newsublen + prevsublen);\n\n+                prevlen = (int)STRLEN(reg_prev_sub);\n+                tmpsub = alloc(STRLEN(newsub) + prevlen);\n\n-                    size_t prefixlen = p - newsub;\n-                    mch_memmove(tmpsub, newsub, prefixlen);\n-                    mch_memmove(tmpsub + prefixlen, reg_prev_sub, prevsublen);\n\n+                    len = (int)(p - newsub);\n+                    mch_memmove(tmpsub, newsub, (size_t)len);\n+                    mch_memmove(tmpsub + len, reg_prev_sub, (size_t)prevlen);\n\n-                    STRCPY(tmpsub + prefixlen + prevsublen, p + 1);\n\n+                    STRCPY(tmpsub + len + prevlen, p + 1);\n\n-                    p = newsub + prefixlen + prevsublen;\n\n+                    p = newsub + len + prevlen;\n\n",
    "3": "+    char_u\t*tmpsub;\n\n"
}