diff --git a/libr/bin/p/bin_dex.c b/libr/bin/p/bin_dex.c
index be0c0d320d6ac..7293c389a2e08 100644
--- a/libr/bin/p/bin_dex.c
+++ b/libr/bin/p/bin_dex.c
@@ -1496,7 +1496,7 @@ static int dex_loadcode(RBinFile *arch, RBinDexObj *bin) {
 				continue;
 			}
 
-			if (bin->methods[i].class_id > bin->header.types_size) {
+			if (bin->methods[i].class_id >= bin->header.types_size) {
 				continue;
 			}
 
@@ -1582,15 +1582,15 @@ static RList *classes(RBinFile *arch) {
 	return bin->classes_list;
 }
 
-static bool already_entry(RList *entries, ut64 vaddr) {
+static int already_entry(RList *entries, ut64 vaddr) {
 	RBinAddr *e;
 	RListIter *iter;
 	r_list_foreach (entries, iter, e) {
 		if (e->vaddr == vaddr) {
-			return true;
+			return 1;
 		}
 	}
-	return false;
+	return 0;
 }
 
 static RList *entries(RBinFile *arch) {
diff --git a/libr/core/cbin.c b/libr/core/cbin.c
index 0358a2cf60ec6..77eca601db245 100644
--- a/libr/core/cbin.c
+++ b/libr/core/cbin.c
@@ -2722,18 +2722,19 @@ R_API int r_core_bin_info(RCore *core, int action, int mode, int va, RCoreBinFil
 	if ((action & R_CORE_BIN_ACC_MEM)) ret &= bin_mem (core, mode);
 	if ((action & R_CORE_BIN_ACC_VERSIONINFO)) ret &= bin_versioninfo (core, mode);
 	if ((action & R_CORE_BIN_ACC_SIGNATURE)) ret &= bin_signature (core, mode);
-//	if ((action & R_CORE_BIN_ACC_FIELDS)) ret &= bin_fields (core, mode, va);
-	if (IS_MODE_SIMPLE (mode)) {
-		if ((action & R_CORE_BIN_ACC_HEADER) || action & R_CORE_BIN_ACC_FIELDS) {
-			/* ignore mode, just for quiet/simple here */
-			ret &= bin_fields (core, 0, va);
-		}
-	} else {
-		if (IS_MODE_NORMAL(mode)) {
-			ret &= bin_header (core, mode);
-		} else {
+	if ((action & R_CORE_BIN_ACC_FIELDS)) {
+		if (IS_MODE_SIMPLE (mode)) {
 			if ((action & R_CORE_BIN_ACC_HEADER) || action & R_CORE_BIN_ACC_FIELDS) {
-				ret &= bin_fields (core, mode, va);
+				/* ignore mode, just for quiet/simple here */
+				ret &= bin_fields (core, 0, va);
+			}
+		} else {
+			if (IS_MODE_NORMAL(mode)) {
+				ret &= bin_header (core, mode);
+			} else {
+				if ((action & R_CORE_BIN_ACC_HEADER) || action & R_CORE_BIN_ACC_FIELDS) {
+					ret &= bin_fields (core, mode, va);
+				}
 			}
 		}
 	}
diff --git a/sys/asan.sh b/sys/asan.sh
index 0772fd576008d..3773f1abf83f6 100755
--- a/sys/asan.sh
+++ b/sys/asan.sh
@@ -22,12 +22,12 @@ printf "\033[32m"
 echo "========================================================================="
 printf "\033[0m"
 sleep 1
-#export LDFLAGS="-lasan"
+export LDFLAGS="-lasan"
 
 for a in $ASAN ; do
 	export CFLAGS="${CFLAGS} -fsanitize=$a"
 done
-#export CFLAGS="${CFLAGS} -lasan"
+export CFLAGS="${CFLAGS} -lasan"
 
 echo 'int main(){return 0;}' > .a.c
 [ -z "${CC}" ] && CC=gcc
diff --git a/libr/bin/p/bin_dex.c b/libr/bin/p/bin_dex.c
index 74b6df706b54a..be0c0d320d6ac 100644
--- a/libr/bin/p/bin_dex.c
+++ b/libr/bin/p/bin_dex.c
@@ -1496,7 +1496,7 @@ static int dex_loadcode(RBinFile *arch, RBinDexObj *bin) {
 				continue;
 			}
 
-			if (bin->methods[i].class_id > bin->header.types_size - 1) {
+			if (bin->methods[i].class_id > bin->header.types_size) {
 				continue;
 			}
 
diff --git a/sys/asan.sh b/sys/asan.sh
index 3773f1abf83f6..0772fd576008d 100755
--- a/sys/asan.sh
+++ b/sys/asan.sh
@@ -22,12 +22,12 @@ printf "\033[32m"
 echo "========================================================================="
 printf "\033[0m"
 sleep 1
-export LDFLAGS="-lasan"
+#export LDFLAGS="-lasan"
 
 for a in $ASAN ; do
 	export CFLAGS="${CFLAGS} -fsanitize=$a"
 done
-export CFLAGS="${CFLAGS} -lasan"
+#export CFLAGS="${CFLAGS} -lasan"
 
 echo 'int main(){return 0;}' > .a.c
 [ -z "${CC}" ] && CC=gcc
