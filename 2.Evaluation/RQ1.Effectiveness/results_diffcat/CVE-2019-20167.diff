diff --git a/src/isomedia/box_code_apple.c b/src/isomedia/box_code_apple.c
index 73a8c438a9..5d8d4fba73 100644
--- a/src/isomedia/box_code_apple.c
+++ b/src/isomedia/box_code_apple.c
@@ -116,10 +116,12 @@ GF_Err ilst_item_Read(GF_Box *s,GF_BitStream *bs)
 	if (sub_type == GF_ISOM_BOX_TYPE_DATA ) {
 		e = gf_isom_box_parse(&a, bs);
 
-		if (!e && ptr->size < a->size) {
+		if (!e && a && ptr->size < a->size) {
 			GF_LOG(GF_LOG_ERROR, GF_LOG_CONTAINER, ("[isom] not enough bytes in box %s: %d left, reading %d (file %s, line %d)\n", gf_4cc_to_str(ptr->type), ptr->size, a->size, __FILE__, __LINE__ )); \
 			e = GF_ISOM_INVALID_FILE;
 		}
+		if (!a) e = GF_ISOM_INVALID_FILE;
+
 		if (e) {
 			if (a) gf_isom_box_del(a);
 			return e;
diff --git a/src/isomedia/box_code_drm.c b/src/isomedia/box_code_drm.c
index 2577392342..c71958cbfd 100644
--- a/src/isomedia/box_code_drm.c
+++ b/src/isomedia/box_code_drm.c
@@ -997,6 +997,8 @@ GF_Err tenc_Read(GF_Box *s, GF_BitStream *bs)
 
 	if ((ptr->isProtected == 1) && !ptr->Per_Sample_IV_Size) {
 		ptr->constant_IV_size = gf_bs_read_u8(bs);
+		if (ptr->constant_IV_size > sizeof(ptr->constant_IV))
+			return GF_ISOM_INVALID_FILE;
 		gf_bs_read_data(bs, (char *) ptr->constant_IV, ptr->constant_IV_size);
 		ISOM_DECREASE_SIZE(ptr, (1 + ptr->constant_IV_size) );
 
@@ -1375,7 +1377,7 @@ GF_Err senc_Parse(GF_BitStream *bs, GF_TrackBox *trak, void *traf, GF_SampleEncr
 				for (j = 0; j < sai->subsample_count; j++) {
 					if (gf_bs_get_size(bs) - gf_bs_get_position(bs) < 6) {
 						gf_isom_cenc_samp_aux_info_del(sai);
-						if (trak->moov->mov->FragmentsFlags & GF_ISOM_FRAG_READ_DEBUG) {
+						if (trak && trak->moov && trak->moov->mov && trak->moov->mov->FragmentsFlags & GF_ISOM_FRAG_READ_DEBUG) {
 							gf_bs_seek(bs, pos);
 							GF_LOG(GF_LOG_WARNING, GF_LOG_CONTAINER, ("[isobmf] Failed to parse SENC box, invalid SAI size\n" ));
 							return GF_OK;
diff --git a/src/odf/descriptors.c b/src/odf/descriptors.c
index f72755b77b..662dfbc5d4 100644
--- a/src/odf/descriptors.c
+++ b/src/odf/descriptors.c
@@ -564,6 +564,8 @@ GF_Err gf_odf_avc_cfg_write_bs(GF_AVCConfig *cfg, GF_BitStream *bs)
 {
 	u32 i, count;
 
+	if (!cfg) return GF_BAD_PARAM;
+
 	count = gf_list_count(cfg->sequenceParameterSets);
 
 	if (!cfg->write_annex_b) {
