diff --git a/gtkwave3-gtk3/ChangeLog b/gtkwave3-gtk3/ChangeLog
index aeed699..9054a33 100644
--- a/gtkwave3-gtk3/ChangeLog
+++ b/gtkwave3-gtk3/ChangeLog
@@ -1825,9 +1825,10 @@
 		Updated show-change widget.
 		Fix xml2stems when begin blocks are in functions.
 		Skip over decimal point in timescale in viewer.
-3.4.0	17jan22	Merge in major GUI widget refactoring.
+3.4.0	22jan22	Merge in major GUI widget refactoring.
 		Fixes for toggle menu item access under Tcl.
 		Adds support for "namespace import gtkwave::*" in Tcl.
 		Added dbl_mant_dig_overrides rc environment variable.
 		Path fix for twinwave on Windows.
 		Compiler fix for __GTK_SOCKET_H__ availability.
+		VCD reader fixes for unnamed Icarus begin blocks.
diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt.c b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
index db0efed..319d82c 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt.c
@@ -433,10 +433,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1079,7 +1079,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
index dcfacf3..1e8bd29 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2lxt2.c
@@ -438,10 +438,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1081,7 +1081,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/helpers/vcd2vzt.c b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
index b360f56..d49ac5c 100644
--- a/gtkwave3-gtk3/src/helpers/vcd2vzt.c
+++ b/gtkwave3-gtk3/src/helpers/vcd2vzt.c
@@ -440,10 +440,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1091,7 +1091,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd.c b/gtkwave3-gtk3/src/vcd.c
index c836955..eae6c82 100644
--- a/gtkwave3-gtk3/src/vcd.c
+++ b/gtkwave3-gtk3/src/vcd.c
@@ -427,10 +427,10 @@ for(GLOBALS->yytext_vcd_c_1[len++]=ch;;GLOBALS->yytext_vcd_c_1[len++]=ch)
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_c_1[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_c_1=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_c_1=len;
 	return(T_STRING);
 	}
 
@@ -1183,7 +1183,7 @@ for(;;)
                                 }
 
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd_partial.c b/gtkwave3-gtk3/src/vcd_partial.c
index 9c5990b..6f3ffe8 100644
--- a/gtkwave3-gtk3/src/vcd_partial.c
+++ b/gtkwave3-gtk3/src/vcd_partial.c
@@ -404,10 +404,10 @@ for(GLOBALS->yytext_vcd_partial_c_2[len++]=ch;;GLOBALS->yytext_vcd_partial_c_2[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_partial_c_2[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_partial_c_2=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_partial_c_2=len;
 	return(T_STRING);
 	}
 
@@ -1132,7 +1132,7 @@ for(;;)
                                         }
                                 }
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3-gtk3/src/vcd_recoder.c b/gtkwave3-gtk3/src/vcd_recoder.c
index 3d0e7da..3915988 100644
--- a/gtkwave3-gtk3/src/vcd_recoder.c
+++ b/gtkwave3-gtk3/src/vcd_recoder.c
@@ -932,10 +932,10 @@ for(GLOBALS->yytext_vcd_recoder_c_3[len++]=ch;;GLOBALS->yytext_vcd_recoder_c_3[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_recoder_c_3[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_recoder_c_3=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_recoder_c_3=len;
 	return(T_STRING);
 	}
 
@@ -1525,7 +1525,7 @@ for(;;)
 					}
 				}
 			T_GET;
-			if(tok==T_STRING)
+			if (tok != T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/ChangeLog b/gtkwave3/ChangeLog
index e24b46e..364b4a4 100644
--- a/gtkwave3/ChangeLog
+++ b/gtkwave3/ChangeLog
@@ -1755,3 +1755,4 @@
 3.3.111 01sep21	Fix in fstapi for read start limit time.
 		Fix xml2stems when begin blocks are in functions.
 		Skip over decimal point in timescale in viewer.
+3.4.0	22jan22 VCD reader fixes for unnamed Icarus begin blocks.
diff --git a/gtkwave3/LICENSE.TXT b/gtkwave3/LICENSE.TXT
index 3319877..c9929c2 100644
--- a/gtkwave3/LICENSE.TXT
+++ b/gtkwave3/LICENSE.TXT
@@ -1,6 +1,6 @@
 ##########################################################################
 
-GTKWave 3.3.111 Wave Viewer is Copyright (C) 1999-2021 Tony Bybell.  
+GTKWave 3.4.0 Wave Viewer is Copyright (C) 1999-2021 Tony Bybell.  
 Portions of GTKWave are Copyright (C) 1999-2021 Udi Finkelstein. 
 Context support is Copyright (C) 2007-2021 Kermin Elliott Fleming.
 Trace group support is  Copyright (C) 2009-2021 Donald Baltus.
diff --git a/gtkwave3/configure b/gtkwave3/configure
index a8830e6..34cc8a8 100755
--- a/gtkwave3/configure
+++ b/gtkwave3/configure
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.69 for gtkwave 3.3.111.
+# Generated by GNU Autoconf 2.69 for gtkwave 3.4.0.
 #
 # Report bugs to <bybell@rocketmail.com>.
 #
@@ -580,8 +580,8 @@ MAKEFLAGS=
 # Identity of this package.
 PACKAGE_NAME='gtkwave'
 PACKAGE_TARNAME='gtkwave'
-PACKAGE_VERSION='3.3.111'
-PACKAGE_STRING='gtkwave 3.3.111'
+PACKAGE_VERSION='3.4.0'
+PACKAGE_STRING='gtkwave 3.4.0'
 PACKAGE_BUGREPORT='bybell@rocketmail.com'
 PACKAGE_URL=''
 
@@ -1405,7 +1405,7 @@ if test "$ac_init_help" = "long"; then
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures gtkwave 3.3.111 to adapt to many kinds of systems.
+\`configure' configures gtkwave 3.4.0 to adapt to many kinds of systems.
 
 Usage: $0 [OPTION]... [VAR=VALUE]...
 
@@ -1471,7 +1471,7 @@ fi
 
 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of gtkwave 3.3.111:";;
+     short | recursive ) echo "Configuration of gtkwave 3.4.0:";;
    esac
   cat <<\_ACEOF
 
@@ -1630,7 +1630,7 @@ fi
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-gtkwave configure 3.3.111
+gtkwave configure 3.4.0
 generated by GNU Autoconf 2.69
 
 Copyright (C) 2012 Free Software Foundation, Inc.
@@ -2274,7 +2274,7 @@ cat >config.log <<_ACEOF
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.
 
-It was created by gtkwave $as_me 3.3.111, which was
+It was created by gtkwave $as_me 3.4.0, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   $ $0 $@
@@ -3141,7 +3141,7 @@ fi
 
 # Define the identity of the package.
  PACKAGE='gtkwave'
- VERSION='3.3.111'
+ VERSION='3.4.0'
 
 
 cat >>confdefs.h <<_ACEOF
@@ -11499,7 +11499,7 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by gtkwave $as_me 3.3.111, which was
+This file was extended by gtkwave $as_me 3.4.0, which was
 generated by GNU Autoconf 2.69.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
@@ -11565,7 +11565,7 @@ _ACEOF
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-gtkwave config.status 3.3.111
+gtkwave config.status 3.4.0
 configured by $0, generated by GNU Autoconf 2.69,
   with options \\"\$ac_cs_config\\"
 
diff --git a/gtkwave3/configure.ac b/gtkwave3/configure.ac
index 05f616b..867e508 100644
--- a/gtkwave3/configure.ac
+++ b/gtkwave3/configure.ac
@@ -2,7 +2,7 @@
 # Process this file with autoconf to produce a configure script.
 
 AC_PREREQ(2.59)
-AC_INIT(gtkwave, 3.3.111, bybell@rocketmail.com)
+AC_INIT(gtkwave, 3.4.0, bybell@rocketmail.com)
 AC_CONFIG_SRCDIR([src/vcd.c])
 AM_INIT_AUTOMAKE
 AC_CONFIG_HEADER([config.h])
diff --git a/gtkwave3/contrib/bundle_for_osx/Info-gtkwave.plist b/gtkwave3/contrib/bundle_for_osx/Info-gtkwave.plist
index 218b736..c342086 100644
--- a/gtkwave3/contrib/bundle_for_osx/Info-gtkwave.plist
+++ b/gtkwave3/contrib/bundle_for_osx/Info-gtkwave.plist
@@ -8,7 +8,7 @@
     <key>CFBundleExecutable</key>
     <string>gtkwave</string>
     <key>CFBundleGetInfoString</key>
-    <string>3.3.111, (C) 1999-2021 Tony Bybell http://gtkwave.sourceforge.net</string>
+    <string>3.4.0, (C) 1999-2022 Tony Bybell http://gtkwave.sourceforge.net</string>
     <key>CFBundleIconFile</key>
     <string>gtkwave.icns</string>
     <key>CFBundleIdentifier</key>
@@ -18,13 +18,13 @@
     <key>CFBundlePackageType</key>
     <string>APPL</string>
     <key>CFBundleShortVersionString</key>
-    <string>3.3.111</string>
+    <string>3.4.0</string>
     <key>CFBundleSignature</key>
     <string>????</string>
     <key>CFBundleVersion</key>
-    <string>3.3.111</string>
+    <string>3.4.0</string>
     <key>NSHumanReadableCopyright</key>
-    <string>Copyright 1999 - 2021 Tony Bybell, GNU General Public License.</string>
+    <string>Copyright 1999 - 2022 Tony Bybell, GNU General Public License.</string>
     <key>LSMinimumSystemVersion</key>
     <string>10.6</string>
 
diff --git a/gtkwave3/src/helpers/vcd2lxt.c b/gtkwave3/src/helpers/vcd2lxt.c
index db0efed..319d82c 100644
--- a/gtkwave3/src/helpers/vcd2lxt.c
+++ b/gtkwave3/src/helpers/vcd2lxt.c
@@ -433,10 +433,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1079,7 +1079,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2lxt2.c b/gtkwave3/src/helpers/vcd2lxt2.c
index dcfacf3..1e8bd29 100644
--- a/gtkwave3/src/helpers/vcd2lxt2.c
+++ b/gtkwave3/src/helpers/vcd2lxt2.c
@@ -438,10 +438,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1081,7 +1081,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/helpers/vcd2vzt.c b/gtkwave3/src/helpers/vcd2vzt.c
index b360f56..d49ac5c 100644
--- a/gtkwave3/src/helpers/vcd2vzt.c
+++ b/gtkwave3/src/helpers/vcd2vzt.c
@@ -440,10 +440,10 @@ for(yytext[len++]=ch;;yytext[len++]=ch)
 	if(ch<=' ') break;
 	}
 yytext[len]=0;	/* terminator */
+yylen=len;
 
 if(is_string)
 	{
-	yylen=len;
 	return(T_STRING);
 	}
 
@@ -1091,7 +1091,7 @@ for(;;)
 		case T_SCOPE:
 			T_GET;
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd.c b/gtkwave3/src/vcd.c
index c836955..eae6c82 100644
--- a/gtkwave3/src/vcd.c
+++ b/gtkwave3/src/vcd.c
@@ -427,10 +427,10 @@ for(GLOBALS->yytext_vcd_c_1[len++]=ch;;GLOBALS->yytext_vcd_c_1[len++]=ch)
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_c_1[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_c_1=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_c_1=len;
 	return(T_STRING);
 	}
 
@@ -1183,7 +1183,7 @@ for(;;)
                                 }
 
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd_partial.c b/gtkwave3/src/vcd_partial.c
index a178507..7bffd1c 100644
--- a/gtkwave3/src/vcd_partial.c
+++ b/gtkwave3/src/vcd_partial.c
@@ -403,10 +403,10 @@ for(GLOBALS->yytext_vcd_partial_c_2[len++]=ch;;GLOBALS->yytext_vcd_partial_c_2[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_partial_c_2[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_partial_c_2=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_partial_c_2=len;
 	return(T_STRING);
 	}
 
@@ -1131,7 +1131,7 @@ for(;;)
                                         }
                                 }
 			T_GET;
-			if(tok==T_STRING)
+			if (tok!= T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/vcd_recoder.c b/gtkwave3/src/vcd_recoder.c
index a17e4cd..52539f4 100644
--- a/gtkwave3/src/vcd_recoder.c
+++ b/gtkwave3/src/vcd_recoder.c
@@ -932,10 +932,10 @@ for(GLOBALS->yytext_vcd_recoder_c_3[len++]=ch;;GLOBALS->yytext_vcd_recoder_c_3[l
 	if(ch<=' ') break;
 	}
 GLOBALS->yytext_vcd_recoder_c_3[len]=0;	/* terminator */
+GLOBALS->yylen_vcd_recoder_c_3=len;
 
 if(is_string)
 	{
-	GLOBALS->yylen_vcd_recoder_c_3=len;
 	return(T_STRING);
 	}
 
@@ -1525,7 +1525,7 @@ for(;;)
 					}
 				}
 			T_GET;
-			if(tok==T_STRING)
+			if (tok != T_END && tok != T_EOF)
 				{
 				struct slist *s;
 				s=(struct slist *)calloc_2(1,sizeof(struct slist));
diff --git a/gtkwave3/src/version.h b/gtkwave3/src/version.h
index b9c4a39..42328be 100644
--- a/gtkwave3/src/version.h
+++ b/gtkwave3/src/version.h
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) Tony Bybell 2010-2019.
+ * Copyright (c) Tony Bybell 2010-2022.
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -10,6 +10,6 @@
 #ifndef WAVE_VERSION_H
 #define WAVE_VERSION_H
 
-#define WAVE_VERSION_INFO "GTKWave Analyzer v" PACKAGE_VERSION " (w)1999-2020 BSI"
+#define WAVE_VERSION_INFO "GTKWave Analyzer v" PACKAGE_VERSION " (w)1999-2022 BSI"
 
 #endif
