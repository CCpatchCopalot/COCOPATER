diff --git a/src/podofo/main/PdfDictionary.cpp b/src/podofo/main/PdfDictionary.cpp
--- a/src/podofo/main/PdfDictionary.cpp
+++ b/src/podofo/main/PdfDictionary.cpp
@@ -146,18 +146,19 @@ PdfObject* PdfDictionary::findKey(const string_view& key) const
 PdfObject* PdfDictionary::findKeyParent(const string_view& key) const
 {
     utls::RecursionGuard guard;
     if (obj == nullptr)
     {
-        if (parent == nullptr)
+        if (parent == nullptr || parent->GetIndirectReference() == GetOwner()->GetIndirectReference())
         {
             return nullptr;
         }
         else
         {
-            if (parent->IsDictionary())
-                return parent->GetDictionary().findKeyParent(key);
+            PdfDictionary* parentDict;
+            if (parent->TryGetDictionary(parentDict))
+                return parentDict->findKeyParent(key);
             else
                 return nullptr;
         }
