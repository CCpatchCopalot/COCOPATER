{
    "0": "-    BN_CTX* ctx;\n\n+    BN_CTX* ctx = NULL;\n\n",
    "1": "-    BYTE* input_reverse;\n-    BYTE* modulus_reverse;\n-    BYTE* exponent_reverse;\n-    BIGNUM *mod, *exp, *x, *y;\n-    input_reverse = (BYTE*)malloc(2 * key_length + exponent_size);\n\n+    BYTE* input_reverse = NULL;\n+    BYTE* modulus_reverse = NULL;\n+    BYTE* exponent_reverse = NULL;\n+    BIGNUM* mod = NULL;\n+    BIGNUM* exp = NULL;\n+    BIGNUM* x = NULL;\n+    BIGNUM* y = NULL;\n+    size_t bufferSize = 2 * key_length + exponent_size;\n+    if (!input || (length < 0) || (exponent_size < 0) || !modulus || !exponent || !output) {\n+        return -1;\n+    }\n+    if (length > bufferSize) {\n+        bufferSize = length;\n+    }\n+    input_reverse = (BYTE*)calloc(bufferSize, 1);\n\n-    BN_bin2bn(modulus_reverse, key_length, mod);\n-    BN_bin2bn(exponent_reverse, exponent_size, exp);\n-    BN_bin2bn(input_reverse, length, x);\n-    BN_mod_exp(y, x, exp, mod, ctx);\n\n+    if (!BN_bin2bn(modulus_reverse, key_length, mod)) {\n+        goto fail;\n+    }\n+    if (!BN_bin2bn(exponent_reverse, exponent_size, exp)) {\n+        goto fail;\n+    }\n+    if (!BN_bin2bn(input_reverse, length, x)) {\n+        goto fail;\n+    }\n+    if (BN_mod_exp(y, x, exp, mod, ctx) != 1) {\n+        goto fail;\n+    }\n\n-    if (output_length < (int)key_length) {\n\n+    if (output_length < key_length) {\n\n-    BYTE* input_reverse = NULL;\n-    BYTE* modulus_reverse = NULL;\n-    BYTE* exponent_reverse = NULL;\n-    BIGNUM* mod = NULL;\n-    BIGNUM* exp = NULL;\n-    BIGNUM* x = NULL;\n-    BIGNUM* y = NULL;\n-    size_t bufferSize = 2 * key_length + exponent_size;\n-    if (!input || (length < 0) || (exponent_size < 0) || !modulus || !exponent || !output) {\n-        return -1;\n-    }\n-    if (length > bufferSize) {\n-        bufferSize = length;\n-    }\n-    input_reverse = (BYTE*)calloc(bufferSize, 1);\n\n+    BYTE* input_reverse;\n+    BYTE* modulus_reverse;\n+    BYTE* exponent_reverse;\n+    BIGNUM *mod, *exp, *x, *y;\n+    input_reverse = (BYTE*)malloc(2 * key_length + exponent_size);\n\n-    if (!BN_bin2bn(modulus_reverse, key_length, mod)) {\n-        goto fail;\n-    }\n-    if (!BN_bin2bn(exponent_reverse, exponent_size, exp)) {\n-        goto fail;\n-    }\n-    if (!BN_bin2bn(input_reverse, length, x)) {\n-        goto fail;\n-    }\n-    if (BN_mod_exp(y, x, exp, mod, ctx) != 1) {\n-        goto fail;\n-    }\n\n+    BN_bin2bn(modulus_reverse, key_length, mod);\n+    BN_bin2bn(exponent_reverse, exponent_size, exp);\n+    BN_bin2bn(input_reverse, length, x);\n+    BN_mod_exp(y, x, exp, mod, ctx);\n\n-    if (output_length < key_length) {\n\n+    if (output_length < (int)key_length) {\n\n",
    "2": "+    if (output_length < 0) {\n+        goto fail;\n+    }\n\n",
    "3": "+fail:\n\n",
    "4": "-    BN_CTX* ctx = NULL;\n\n+    BN_CTX* ctx;\n\n",
    "5": "-    if (output_length < 0) {\n-        goto fail;\n-    }\n\n",
    "6": "-fail:\n\n"
}