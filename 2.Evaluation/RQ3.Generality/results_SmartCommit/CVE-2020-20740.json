{
    "0": "-    char *header, *c;\n-    header = get_header(fp);\n-    if ((c = strstr(header, \"%PDF-\")) && (c + strlen(\"%PDF-M.m\") + 2)) {\n\n+    char *header = get_header(fp);\n+    const char *c;\n+    if ((c = strstr(header, \"%PDF-\")) && ((c + 6)[0] == '.') && isdigit((c + 5)[0]) && isdigit((c + 7)[0])) {\n\n-    char *header = get_header(fp);\n-    const char *c;\n-    if ((c = strstr(header, \"%PDF-\")) && ((c + 6)[0] == '.') && isdigit((c + 5)[0]) && isdigit((c + 7)[0])) {\n\n+    char *header, *c;\n+    header = get_header(fp);\n+    if ((c = strstr(header, \"%PDF-\")) && (c + strlen(\"%PDF-M.m\") + 2)) {\n\n",
    "1": "-    int is_pdf;\n\n",
    "2": "-    header = get_header(fp);\n-    if (header && strstr(header, \"%PDF-\")) {\n-        is_pdf = 1;\n-    } else {\n-        is_pdf = 0;\n\n+    if (!(header = get_header(fp))) {\n+        return 0;\n\n-    if (!(header = get_header(fp))) {\n-        return 0;\n\n+    header = get_header(fp);\n+    if (header && strstr(header, \"%PDF-\")) {\n+        is_pdf = 1;\n+    } else {\n+        is_pdf = 0;\n\n-    const char *c = strstr(header, \"%PDF-\");\n-    const int is_pdf = c && ((c - header+strlen(\"%PDF-M.m\")) < 1024);\n\n",
    "3": "+    const char *c = strstr(header, \"%PDF-\");\n+    const int is_pdf = c && ((c - header+strlen(\"%PDF-M.m\")) < 1024);\n\n",
    "4": "+    int is_pdf;\n\n"
}