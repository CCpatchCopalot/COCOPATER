{
    "0": "+    cscf->max_errors = NGX_CONF_UNSET_UT;\n\n",
    "1": "-    cscf->max_errors = NGX_CONF_UNSET_UT;\n\n",
    "2": "+    ngx_conf_merge_uint_value(conf->max_errors, prev->max_errors, 5);\n\n",
    "3": "-    ngx_conf_merge_uint_value(conf->max_errors, prev->max_errors, 5);\n\n",
    "4": "-    if (rc == NGX_IMAP_NEXT || rc == NGX_MAIL_PARSE_VALID_COMMAND) {\n\n+    if (rc == NGX_MAIL_PARSE_VALID_COMMAND) {\n+        s->errors++;\n+        if (s->errors >= cscf->max_errors) {\n+            ngx_log_error(NGX_LOG_FO, c->log, 0, \"client sent too many invalid commands\");\n+            s->quit = 1;\n+        }\n+        return rc;\n+    }\n+    if (rc == NGX_IMAP_NEXT) {\n\n-    if (rc == NGX_MAIL_PARSE_VALID_COMMAND) {\n-        s->errors++;\n-        if (s->errors >= cscf->max_errors) {\n-            ngx_log_error(NGX_LOG_FO, c->log, 0, \"client sent too many invalid commands\");\n-            s->quit = 1;\n-        }\n-        return rc;\n-    }\n-    if (rc == NGX_IMAP_NEXT) {\n\n+    if (rc == NGX_IMAP_NEXT || rc == NGX_MAIL_PARSE_VALID_COMMAND) {\n\n"
}