{
    "0": "+            case TCP_OPT_MD5:\n+                SCLogDebug(\"MD5 option, len %u\", olen);\n+                if (olen != 18) {\n+                    ENGE_SET_VALID_EVENT(p,TCP_OPT_VALID_LEN);\n+                } else {\n+                    p->tcpvars.md5_option_present = true;\n+                }\n+                break;\n+            case TCP_OPT_AO:\n+                SCLogDebug(\"AU option, len %u\", olen);\n+                if (olen < 4) {\n+                    ENGE_SET_VALID_EVENT(p,TCP_OPT_VALID_LEN);\n+                } else {\n+                    p->tcpvars.ao_option_present = true;\n+                }\n+                break;\n\n",
    "1": "-            case TCP_OPT_MD5:\n-                SCLogDebug(\"MD5 option, len %u\", olen);\n-                if (olen != 18) {\n-                    ENGE_SET_VALID_EVENT(p,TCP_OPT_VALID_LEN);\n-                } else {\n-                    p->tcpvars.md5_option_present = true;\n-                }\n-                break;\n-            case TCP_OPT_AO:\n-                SCLogDebug(\"AU option, len %u\", olen);\n-                if (olen < 4) {\n-                    ENGE_SET_VALID_EVENT(p,TCP_OPT_VALID_LEN);\n-                } else {\n-                    p->tcpvars.ao_option_present = true;\n-                }\n-                break;\n\n",
    "2": "+    if (p->tcpvars.md5_option_present || p->tcpvars.ao_option_present) {\n+        TcpStream *receiver_stream;\n+        if (PKT_IS_TOSERVER(p)) {\n+            receiver_stream = &ssn->server;\n+        } else {\n+            receiver_stream = &ssn->client;\n+        }\n+        SCLogDebug(\"ssn %p: setting STREAMTCP_STREAM_FLAG_RST_RECV on receiver stream\", ssn);\n+        receiver_stream->flags |= STREAMTCP_STREAM_FLAG_RST_RECV;\n+    }\n\n",
    "3": "-    if (p->tcpvars.md5_option_present || p->tcpvars.ao_option_present) {\n-        TcpStream *receiver_stream;\n-        if (PKT_IS_TOSERVER(p)) {\n-            receiver_stream = &ssn->server;\n-        } else {\n-            receiver_stream = &ssn->client;\n-        }\n-        SCLogDebug(\"ssn %p: setting STREAMTCP_STREAM_FLAG_RST_RECV on receiver stream\", ssn);\n-        receiver_stream->flags |= STREAMTCP_STREAM_FLAG_RST_RECV;\n-    }\n\n",
    "4": "+            if (ssn->state == TCP_CLOSED) {\n+                ssn->state = ssn->pstate;\n+            }\n\n",
    "5": "-            if (ssn->state == TCP_CLOSED) {\n-                ssn->state = ssn->pstate;\n-            }\n\n"
}