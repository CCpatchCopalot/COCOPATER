{
    "0": "+        u16 attr_size;\n\n",
    "1": "+        attr_size = le16_to_cpu(e->attr_len);\n+        if (index + sizeof(*e) + attr_size > len) {\n+            return;\n+        }\n\n",
    "2": "-        } else if (e->attr_type == IEEE80211_P2P_ATTR_OPER_CHANNEL) {\n\n+        } else if (e->attr_type == IEEE80211_P2P_ATTR_OPER_CHANNEL && attr_size == (sizeof(struct wilc_attr_oper_ch) - sizeof(*e))) {\n\n-        index += le16_to_cpu(e->attr_len) + sizeof(*e);\n\n+        index += sizeof(*e) + attr_size;\n\n-        u16 attr_size;\n\n-        attr_size = le16_to_cpu(e->attr_len);\n-        if (index + sizeof(*e) + attr_size > len) {\n-            return;\n-        }\n\n-        } else if (e->attr_type == IEEE80211_P2P_ATTR_OPER_CHANNEL && attr_size == (sizeof(struct wilc_attr_oper_ch) - sizeof(*e))) {\n\n+        } else if (e->attr_type == IEEE80211_P2P_ATTR_OPER_CHANNEL) {\n\n-        index += sizeof(*e) + attr_size;\n\n+        index += le16_to_cpu(e->attr_len) + sizeof(*e);\n\n"
}