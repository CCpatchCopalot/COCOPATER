{
    "0": "-        PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef stream /W array\");\n\n+        PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef stream /W array\");\n\n",
    "1": "-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef stream /W array\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef stream /W array\");\n\n",
    "2": "-        PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef stream /W array\");\n\n+        PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef stream /W array\");\n\n-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef stream /W array\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef stream /W array\");\n\n-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef Stream /Index\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef Stream /Index\");\n\n-        PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef Stream /Index\");\n\n+        PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef Stream /Index\");\n\n-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Negative field length in XRef stream\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Negative field length in XRef stream\");\n\n-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid entry length in XRef stream\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid entry length in XRef stream\");\n\n-    size_t offset = 0;\n\n+    char* cursor = buffer.data();\n\n-        if ((offset + count * entryLen) > buffer.size()) {\n-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid count in XRef stream\");\n-        }\n\n+            if ((size_t)(cursor - buffer.data()) >= buffer.size()) {\n+                PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid count in XRef stream\");\n+            }\n\n-                readXRefStreamEntry(entry, buffer.data() + offset, wArray);\n\n+                readXRefStreamEntry(entry, cursor, wArray);\n\n-            offset += entryLen;\n\n+            cursor += entryLen;\n\n",
    "3": "-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef Stream /Index\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef Stream /Index\");\n\n",
    "4": "-        PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid XRef Stream /Index\");\n\n+        PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid XRef Stream /Index\");\n\n",
    "5": "-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Negative field length in XRef stream\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Negative field length in XRef stream\");\n\n",
    "6": "-            PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid entry length in XRef stream\");\n\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid entry length in XRef stream\");\n\n",
    "7": "-    char* cursor = buffer.data();\n\n+    size_t offset = 0;\n\n",
    "8": "+        if ((offset + count * entryLen) > buffer.size()) {\n+            PODOFO_RAISE_ERROR_FO(PdfErrorCode::InvalidXRefStream, \"Invalid count in XRef stream\");\n+        }\n\n",
    "9": "-            if ((size_t)(cursor - buffer.data()) >= buffer.size()) {\n-                PODOFO_RAISE_ERROR_FO(PdfErrorCode::NoXRef, \"Invalid count in XRef stream\");\n-            }\n\n",
    "10": "-                readXRefStreamEntry(entry, cursor, wArray);\n\n+                readXRefStreamEntry(entry, buffer.data() + offset, wArray);\n\n",
    "11": "-            cursor += entryLen;\n\n+            offset += entryLen;\n\n"
}