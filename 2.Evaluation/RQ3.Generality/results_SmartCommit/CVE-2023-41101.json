{
    "0": "+    if ( strlen(query) < 1 ) {\n+        return send_error(connection, 511);\n+    } else {\n\n",
    "1": "+            debug(LOG_DEBUG, \"PreAuth: User Agent ptr is [ %d ]\", &user_agent);\n\n",
    "2": "+            debug(LOG_DEBUG, \"PreAuth: MHD User Agent ptr is [ %d ]\", &user_agent);\n\n",
    "3": "+}\n\n",
    "4": "-    if ( strlen(query) < 1 ) {\n-        return send_error(connection, 511);\n-    } else {\n\n",
    "5": "-            debug(LOG_DEBUG, \"PreAuth: User Agent ptr is [ %d ]\", &user_agent);\n\n-            debug(LOG_DEBUG, \"PreAuth: MHD User Agent ptr is [ %d ]\", &user_agent);\n\n",
    "6": "-}\n\n",
    "7": "-    int j;\n\n+    int j = 4;\n\n-            debug(LOG_WARNG, \" Query string exceeds the maximum of %d bytes so has been truncated.\", QUERYMAXLEN/2);\n\n+            debug(LOG_WARNG, \" Query string is too long, invalid or corrupt so is ignored.\");\n\n-    int j = 4;\n\n+    int j;\n\n-        debug(LOG_DEBUG, \" cumulative element length is [%d]\", length);\n\n-        if (length + j < QUERYMAXLEN) {\n\n+        if (QUERYMAXLEN - strlen(query_str) > length - j) {\n\n-            debug(LOG_WARNG, \" Query string is too long, invalid or corrupt so is ignored.\");\n\n+            debug(LOG_WARNG, \" Query string exceeds the maximum of %d bytes so has been truncated.\", QUERYMAXLEN/2);\n\n",
    "8": "+        debug(LOG_DEBUG, \" cumulative element length is [%d]\", length);\n\n",
    "9": "+        if (length + j < QUERYMAXLEN) {\n\n",
    "10": "-        if (QUERYMAXLEN - strlen(query_str) > length - j) {\n\n"
}