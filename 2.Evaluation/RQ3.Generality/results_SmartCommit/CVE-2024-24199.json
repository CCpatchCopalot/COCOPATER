{
    "0": "-        for (nlh = (struct nlmsghdr *)buf; NLMSG_OK(nlh, len); nlh = NLMSG_NEXT(nlh, len)) {\n\n+        unsigned int rtalen = len;\n+        for (nlh = (struct nlmsghdr *)buf; NLMSG_OK(nlh, rtalen); nlh = NLMSG_NEXT(nlh, rtalen)) {\n\n-        unsigned int rtalen = len;\n-        for (nlh = (struct nlmsghdr *)buf; NLMSG_OK(nlh, rtalen); nlh = NLMSG_NEXT(nlh, rtalen)) {\n\n+        for (nlh = (struct nlmsghdr *)buf; NLMSG_OK(nlh, len); nlh = NLMSG_NEXT(nlh, len)) {\n\n+            int rtalen = RTM_PAYLOAD(nlh);\n\n",
    "1": "-            int rtalen = RTM_PAYLOAD(nlh);\n\n",
    "2": "-    value = ntohl(*((unsigned int *)(*buffer)));\n\n+    if ((uintptr_t)(*buffer) % 4 == 0) {\n+        value = *((unsigned int *)(*buffer));\n+    } else {\n+        memcpy(&value, *buffer, 4);\n+    }\n\n-    return value;\n\n+    return ntohl(value);\n\n-    if ((uintptr_t)(*buffer) % 4 == 0) {\n-        value = *((unsigned int *)(*buffer));\n-    } else {\n-        memcpy(&value, *buffer, 4);\n-    }\n\n+    value = ntohl(*((unsigned int *)(*buffer)));\n\n-    return ntohl(value);\n\n+    return value;\n\n-    value = ntohs(*((unsigned short *)(*buffer)));\n\n+    if ((uintptr_t)(*buffer) % 2 == 0) {\n+        value = *((unsigned short *)(*buffer));\n+    } else {\n+        memcpy(&value, *buffer, 2);\n+    }\n\n-    return value;\n\n+    return ntohs(value);\n\n-    if ((uintptr_t)(*buffer) % 2 == 0) {\n-        value = *((unsigned short *)(*buffer));\n-    } else {\n-        memcpy(&value, *buffer, 2);\n-    }\n\n+    value = ntohs(*((unsigned short *)(*buffer)));\n\n-    return ntohs(value);\n\n+    return value;\n\n+    } else {\n+        memcpy(*buffer, &value, 2);\n+    }\n+    *buffer += 2;\n+}\n+static void _dns_write_shortptr(unsigned char **buffer, void *ptrvalue) {\n+    unsigned short value;\n+    if ((uintptr_t)ptrvalue % 2 == 0) {\n+        value = *(unsigned short *)ptrvalue;\n+    } else {\n+        memcpy(&value, ptrvalue, 2);\n+    }\n+    value = htons(value);\n+    if ((uintptr_t)(*buffer) % 2 == 0) {\n+        *((unsigned short *)(*buffer)) = value;\n+    } else {\n+        memcpy(*buffer, &value, 2);\n+    }\n\n-    if ((uintptr_t)(*buffer) % 2 == 0) {\n\n+    } else {\n+        memcpy(*buffer, &value, 4);\n+    }\n+    *buffer += 4;\n+}\n+static void _dns_write_intptr(unsigned char **buffer, void *ptrvalue) {\n+    unsigned int value;\n+    if ((uintptr_t)ptrvalue % 4 == 0) {\n+        value = *(unsigned int *)ptrvalue;\n+    } else {\n+        memcpy(&value, ptrvalue, 4);\n+    }\n+    value = htonl(value);\n+    if ((uintptr_t)(*buffer) % 4 == 0) {\n+        *((unsigned int *)(*buffer)) = value;\n+    } else {\n+        memcpy(*buffer, &value, 4);\n+    }\n\n-    if ((uintptr_t)(*buffer) % 4 == 0) {\n\n",
    "3": "-    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n+    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n+    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n+    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n-    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n-    _dns_write_shortptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_short(&context->ptr, *(unsigned short *)data_context.ptr);\n\n-    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n+    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n+    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n+    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n+    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n+    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n-    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n-    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n-    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n-    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n-    _dns_write_intptr(&context->ptr, data_context.ptr);\n\n+    _dns_write_int(&context->ptr, *(unsigned int *)data_context.ptr);\n\n",
    "4": "+    if ((uintptr_t)(*buffer) % 2 == 0) {\n\n",
    "5": "+    if ((uintptr_t)(*buffer) % 4 == 0) {\n\n",
    "6": "-    strncpy(log->logdir, dirname(log_file), sizeof(log->logdir));\n\n+    strncpy(log->logdir, dirname(log_file), sizeof(log->logdir) - 1);\n\n",
    "7": "-    strncpy(log->logname, basename(log_file), sizeof(log->logname));\n\n+    strncpy(log->logname, basename(log_file), sizeof(log->logname) - 1);\n\n",
    "8": "-    strncpy(log->logdir, dirname(log_file), sizeof(log->logdir) - 1);\n\n+    strncpy(log->logdir, dirname(log_file), sizeof(log->logdir));\n\n",
    "9": "-    strncpy(log->logname, basename(log_file), sizeof(log->logname) - 1);\n\n+    strncpy(log->logname, basename(log_file), sizeof(log->logname));\n\n",
    "10": "-        strncpy(oldestlog->name, entry->d_name, sizeof(oldestlog->name) - 1);\n\n+        strncpy(oldestlog->name, entry->d_name, sizeof(oldestlog->name));\n\n",
    "11": "-        strncpy(oldestlog->name, entry->d_name, sizeof(oldestlog->name));\n\n+        strncpy(oldestlog->name, entry->d_name, sizeof(oldestlog->name) - 1);\n\n"
}