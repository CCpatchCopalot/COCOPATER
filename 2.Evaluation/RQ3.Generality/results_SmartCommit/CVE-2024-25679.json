{
    "0": "+                                picoquic_crypto_context_free(&cnx->crypto_context[2]);\n\n",
    "1": "-                                picoquic_crypto_context_free(&cnx->crypto_context[2]);\n\n",
    "2": "+                            if(cnx->local_parameters.original_destination_connection_id.id_len == 0) {\n\n",
    "3": "+                            }\n\n",
    "4": "+                    if (ret == 0 && cnx->crypto_context[2].aead_decrypt != NULL && cnx->crypto_context[2].aead_encrypt != NULL) {\n+                        picoquic_implicit_handshake_ack(cnx, cnx->path[0], picoquic_packet_context_initial, current_time);\n+                        picoquic_crypto_context_free(&cnx->crypto_context[0]);\n+                    }\n\n",
    "5": "-                            if(cnx->local_parameters.original_destination_connection_id.id_len == 0) {\n\n",
    "6": "-                            }\n\n-                }\n\n",
    "7": "-                    if (ret == 0 && cnx->crypto_context[2].aead_decrypt != NULL && cnx->crypto_context[2].aead_encrypt != NULL) {\n-                        picoquic_implicit_handshake_ack(cnx, cnx->path[0], picoquic_packet_context_initial, current_time);\n-                        picoquic_crypto_context_free(&cnx->crypto_context[0]);\n-                    }\n\n",
    "8": "-    uint32_t aead_checksum_length = (uint32_t)picoquic_aead_get_checksum_length(aead_context);\n\n+    uint32_t aead_checksum_length;\n+    if(aead_context != NULL) {\n+        aead_checksum_length = (uint32_t)picoquic_aead_get_checksum_length(aead_context);\n+    } else {\n+        return 0;\n+    }\n\n-    uint32_t aead_checksum_length;\n-    if(aead_context != NULL) {\n-        aead_checksum_length = (uint32_t)picoquic_aead_get_checksum_length(aead_context);\n-    } else {\n-        return 0;\n-    }\n\n+    uint32_t aead_checksum_length = (uint32_t)picoquic_aead_get_checksum_length(aead_context);\n\n",
    "9": "+            cnx->active_connection_id_count = 1;\n\n",
    "10": "-            cnx->active_connection_id_count = 1;\n\n-        cnx->active_connection_id_count++;\n\n",
    "11": "-        picoquic_packet_t* p_next = p->next_packet;\n\n+        picoquic_packet_t* p_next = p->previous_packet;\n\n-        picoquic_packet_t* p_next = p->previous_packet;\n\n+        picoquic_packet_t* p_next = p->next_packet;\n\n",
    "12": "-    if ((bytes = picoquic_frames_varint_decode(bytes + picoquic_varint_skip(bytes), bytes_max, &frame->sequence)) == NULL\n\n+    if (cnx->active_connection_id_count >= cnx->local_parameters.active_connection_id_limit) {\n+        picoquic_connection_error(cnx, PICOQUIC_TRANSPORT_CONNECTION_ID_LIMIT_ERROR, picoquic_frame_type_new_connection_id);\n+        picoquic_reinsert_by_wake_time(cnx->quic, cnx, picoquic_current_time());\n+        return (protoop_arg_t) NULL;\n+    } else if ((bytes = picoquic_frames_varint_decode(bytes + picoquic_varint_skip(bytes), bytes_max, &frame->sequence)) == NULL\n\n-    if (cnx->active_connection_id_count >= cnx->local_parameters.active_connection_id_limit) {\n-        picoquic_connection_error(cnx, PICOQUIC_TRANSPORT_CONNECTION_ID_LIMIT_ERROR, picoquic_frame_type_new_connection_id);\n-        picoquic_reinsert_by_wake_time(cnx->quic, cnx, picoquic_current_time());\n-        return (protoop_arg_t) NULL;\n-    } else if ((bytes = picoquic_frames_varint_decode(bytes + picoquic_varint_skip(bytes), bytes_max, &frame->sequence)) == NULL\n\n+    if ((bytes = picoquic_frames_varint_decode(bytes + picoquic_varint_skip(bytes), bytes_max, &frame->sequence)) == NULL\n\n",
    "13": "+        cnx->active_connection_id_count++;\n\n",
    "14": "-    if (ret == 0 && pc == picoquic_packet_context_handshake) {\n\n+    if (ret == 0 && pc == picoquic_packet_context_handshake && cnx->crypto_context[0].aead_encrypt != NULL) {\n\n-    if (ret == 0 && pc == picoquic_packet_context_handshake && cnx->crypto_context[0].aead_encrypt != NULL) {\n\n+    if (ret == 0 && pc == picoquic_packet_context_handshake) {\n\n",
    "15": "+                if((*pcnx)->crypto_context[0].aead_decrypt != NULL) {\n\n",
    "16": "+                }\n\n",
    "17": "-                if((*pcnx)->crypto_context[0].aead_decrypt != NULL) {\n\n",
    "18": "-    if (is_cleartext_mode || cnx->crypto_context[2].aead_encrypt == NULL) {\n\n+    if (is_cleartext_mode && cnx->crypto_context[2].aead_encrypt == NULL && cnx->crypto_context[0].aead_encrypt != NULL) {\n\n",
    "19": "-    } else {\n\n+    } else if (cnx->crypto_context[2].aead_encrypt != NULL) {\n\n",
    "20": "+    } else if(cnx->crypto_context[3].aead_encrypt != NULL) {\n+        ret = picoquic_aead_get_checksum_length(cnx->crypto_context[3].aead_encrypt);\n\n",
    "21": "-    if (is_cleartext_mode && cnx->crypto_context[2].aead_encrypt == NULL && cnx->crypto_context[0].aead_encrypt != NULL) {\n\n+    if (is_cleartext_mode || cnx->crypto_context[2].aead_encrypt == NULL) {\n\n-    } else if (cnx->crypto_context[2].aead_encrypt != NULL) {\n\n+    } else {\n\n-    } else if(cnx->crypto_context[3].aead_encrypt != NULL) {\n-        ret = picoquic_aead_get_checksum_length(cnx->crypto_context[3].aead_encrypt);\n\n"
}