{
    "0": "-    size_t size = 0, size_internal = size_external;\n\n+    size_t size_internal = size_external;\n\n",
    "1": "-        size = buf.read_uint32(0, bigEndian);\n\n+        const size_t size = buf.read_uint32(0, bigEndian);\n\n",
    "2": "+            const size_t tv_size = size - 12;\n+            if (tv_size > buf.size()) {\n+                enforce(tv_size <= io_->size() - io_->tell(), Exiv2::ErrorCode::kerCorruptedMetadata);\n+                buf.resize(tv_size);\n+            }\n\n",
    "3": "-            io_->readOrThrow(buf.data(), size - 12);\n\n+            io_->readOrThrow(buf.data(), tv_size);\n\n-    size_t size_internal = size_external;\n\n+    size_t size = 0, size_internal = size_external;\n\n-        const size_t size = buf.read_uint32(0, bigEndian);\n\n+        size = buf.read_uint32(0, bigEndian);\n\n-            const size_t tv_size = size - 12;\n-            if (tv_size > buf.size()) {\n-                enforce(tv_size <= io_->size() - io_->tell(), Exiv2::ErrorCode::kerCorruptedMetadata);\n-                buf.resize(tv_size);\n-            }\n\n-            io_->readOrThrow(buf.data(), tv_size);\n\n+            io_->readOrThrow(buf.data(), size - 12);\n\n"
}