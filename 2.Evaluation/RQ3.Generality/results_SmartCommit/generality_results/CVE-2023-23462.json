{
    "0": "-bool peconv::validate_ptr( const void* buffer_bgn, SIZE_T buffer_size, const void* field_bgn, SIZE_T field_size) {\n\n+bool peconv::validate_ptr( const void* buffer_bgn, size_t buffer_size, const void* field_bgn, size_t field_size) {\n\n",
    "1": "-    BYTE* _end = _start + buffer_size;\n\n",
    "2": "-    BYTE* _field_end = (BYTE*)field_bgn + field_size;\n\n",
    "3": "-    if (_field_end > _end) {\n\n+    size_t start_delta = (ULONG_PTR)_field_start - (ULONG_PTR)_start;\n+    size_t area_size = start_delta + field_size;\n+    if (area_size > buffer_size) {\n+        return false;\n+    }\n+    if (area_size < field_size || area_size < start_delta) {\n+#ifdef _DEBUG\n+        std::cout << \"Integer Overflow, limit exceeded! start_delta: \" << start_delta << \" field_size: \" << field_size << \" area_size: \" << area_size << \"\\n\";\n+#endif\n\n-bool peconv::validate_ptr( const void* buffer_bgn, size_t buffer_size, const void* field_bgn, size_t field_size) {\n\n+bool peconv::validate_ptr( const void* buffer_bgn, SIZE_T buffer_size, const void* field_bgn, SIZE_T field_size) {\n\n+    BYTE* _end = _start + buffer_size;\n\n+    BYTE* _field_end = (BYTE*)field_bgn + field_size;\n\n-    size_t start_delta = (ULONG_PTR)_field_start - (ULONG_PTR)_start;\n-    size_t area_size = start_delta + field_size;\n-    if (area_size > buffer_size) {\n-        return false;\n-    }\n-    if (area_size < field_size || area_size < start_delta) {\n-#ifdef _DEBUG\n-        std::cout << \"Integer Overflow, limit exceeded! start_delta: \" << start_delta << \" field_size: \" << field_size << \" area_size: \" << area_size << \"\\n\";\n-#endif\n\n+    if (_field_end > _end) {\n\n",
    "4": "-    SIZE_T raw_end = 0;\n\n",
    "5": "-        SIZE_T sec_size = next_sec->SizeOfRawData;\n-        raw_end = next_sec->SizeOfRawData + next_sec->PointerToRawData;\n\n+        size_t sec_size = next_sec->SizeOfRawData;\n\n+    SIZE_T raw_end = 0;\n\n-        size_t sec_size = next_sec->SizeOfRawData;\n\n+        SIZE_T sec_size = next_sec->SizeOfRawData;\n+        raw_end = next_sec->SizeOfRawData + next_sec->PointerToRawData;\n\n"
}