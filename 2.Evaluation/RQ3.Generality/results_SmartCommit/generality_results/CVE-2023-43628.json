{
    "0": "-        unsigned char u = *lexer->inbufptr++;\n\n+        unsigned char u;\n+        if (0 == lexer->inbuflen || sizeof(lexer->inbuffer) <= lexer->inbuflen) {\n+            break;\n+        }\n+        u = *lexer->inbufptr++;\n\n-        unsigned char u;\n-        if (0 == lexer->inbuflen || sizeof(lexer->inbuffer) <= lexer->inbuflen) {\n-            break;\n-        }\n-        u = *lexer->inbufptr++;\n\n+        unsigned char u = *lexer->inbufptr++;\n\n-    while (-1 == (read_ret = read(dsock, ibuf, 1024))) {\n\n+    while (0 >= (read_ret = read(dsock, ibuf, 1024))) {\n\n-    lexer->inbuflen = read_ret;\n\n+    lexer->inbuflen = (size_t)read_ret;\n\n-    while (1) {\n\n+    got_header = false;\n+    while (0 < lexer->inbuflen) {\n\n-    if (0 == lexer->inbuflen) {\n\n+    if (0 == lexer->inbuflen || sizeof(lexer->inbuffer) <= lexer->inbuflen) {\n\n-    bool got_header;\n\n-    while (0 >= (read_ret = read(dsock, ibuf, 1024))) {\n\n+    while (-1 == (read_ret = read(dsock, ibuf, 1024))) {\n\n-    lexer->inbuflen = (size_t)read_ret;\n\n+    lexer->inbuflen = read_ret;\n\n-    got_header = false;\n-    while (0 < lexer->inbuflen) {\n\n+    while (1) {\n\n-            got_header = true;\n\n-    if (false == got_header) {\n-        GPSD_LOG(LOG_WARN, errout, \"NTRIP: did not get end of headers.\\n\");\n-    }\n\n-    if (0 == lexer->inbuflen || sizeof(lexer->inbuffer) <= lexer->inbuflen) {\n\n+    if (0 == lexer->inbuflen) {\n\n",
    "1": "-        if (0 == lexer->inbuflen) {\n-            i++;\n-            break;\n-        }\n\n",
    "2": "+        if (0 == lexer->inbuflen) {\n+            i++;\n+            break;\n+        }\n\n",
    "3": "+    bool got_header;\n\n",
    "4": "+            got_header = true;\n\n",
    "5": "+    if (false == got_header) {\n+        GPSD_LOG(LOG_WARN, errout, \"NTRIP: did not get end of headers.\\n\");\n+    }\n\n"
}