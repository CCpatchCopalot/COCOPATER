{
    "0": "-static int parse_single_hex_dump_line(char* rec, guint8 *buf, guint byte_offset) {\n\n+static int parse_single_hex_dump_line(char* rec, guint8 *buf, guint byte_offset, guint pkt_len) {\n\n-            return -1;\n\n+            return PARSE_LE_VALID_CHARACTER;\n\n-            return -1;\n\n+            return PARSE_LE_VALID_CHARACTER;\n\n-        return -1;\n\n+        return PARSE_LE_NO_BYTES_SEEN;\n\n-static int parse_single_hex_dump_line(char* rec, guint8 *buf, guint byte_offset, guint pkt_len) {\n\n+static int parse_single_hex_dump_line(char* rec, guint8 *buf, guint byte_offset) {\n\n-            return PARSE_LE_VALID_CHARACTER;\n\n+            return -1;\n\n-            return PARSE_LE_VALID_CHARACTER;\n-        }\n-        if (byte_offset + num_items_scanned >= pkt_len) {\n-            return PARSE_LE_TOO_MANY_BYTES_SEEN;\n\n+            return -1;\n\n-            return PARSE_LE_VALID_CHARACTER;\n\n+            return -1;\n\n-        return PARSE_LE_NO_BYTES_SEEN;\n\n+        return -1;\n\n",
    "1": "-            return -1;\n\n+            return PARSE_LE_VALID_CHARACTER;\n+        }\n+        if (byte_offset + num_items_scanned >= pkt_len) {\n+            return PARSE_LE_TOO_MANY_BYTES_SEEN;\n\n",
    "2": "-    int\tpkt_len;\n\n+    guint\tpkt_len;\n\n-    guint\tpkt_len;\n\n+    int\tpkt_len;\n\n",
    "3": "-    if (sscanf(line, \"%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s->%12s/\", &sec, &dsec, cap_int, direction, &pkt_len, cap_src, cap_dst) < 5) {\n\n+    if (sscanf(line, \"%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9u:%12s->%12s/\", &sec, &dsec, cap_int, direction, &pkt_len, cap_src, cap_dst) < 5) {\n\n-    if (pkt_len < 0) {\n\n+    if (pkt_len > WTAP_MAX_PACKET_SIZE_STANDARD) {\n\n-        *err_info = g_strdup(\"netscreen: packet header has a negative packet length\");\n-        return FALSE;\n-    }\n-    if ((guint)pkt_len > WTAP_MAX_PACKET_SIZE_STANDARD) {\n-        *err = WTAP_ERR_BAD_FILE;\n-        *err_info = g_strdup_printf(\"netscreen: File has %u-byte packet, bigger than maximum of %u\", (guint)pkt_len, WTAP_MAX_PACKET_SIZE_STANDARD);\n\n+        *err_info = g_strdup_printf(\"netscreen: File has %u-byte packet, bigger than maximum of %u\", pkt_len, WTAP_MAX_PACKET_SIZE_STANDARD);\n\n-        n = parse_single_hex_dump_line(p, pd, offset);\n\n+        n = parse_single_hex_dump_line(p, pd, offset, pkt_len);\n\n-        offset += n;\n-        if (offset > pkt_len) {\n\n+        if (n < 0) {\n+            switch (n) {\n+            case PARSE_LE_VALID_CHARACTER:\n+                *err = WTAP_ERR_BAD_FILE;\n+                *err_info = g_strdup(\"netscreen: invalid character in hex data\");\n+                break;\n+            case PARSE_LE_NO_BYTES_SEEN:\n+                *err = WTAP_ERR_BAD_FILE;\n+                *err_info = g_strdup(\"netscreen: no hex bytes seen in hex data\");\n+                break;\n+            case PARSE_LE_TOO_MANY_BYTES_SEEN:\n\n-            *err_info = g_strdup(\"netscreen: too much hex-data\");\n\n+                *err_info = g_strdup(\"netscreen: number of hex bytes seen in hex data is greater than the packet length\");\n+                break;\n+            default:\n+                *err = WTAP_ERR_TERNAL;\n+                *err_info = g_strdup_printf(\"netscreen: unknown error %d from parse_single_hex_dump_line()\", n);\n+                break;\n+            }\n\n+        offset += n;\n\n-    if (sscanf(line, \"%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9u:%12s->%12s/\", &sec, &dsec, cap_int, direction, &pkt_len, cap_src, cap_dst) < 5) {\n\n+    if (sscanf(line, \"%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s->%12s/\", &sec, &dsec, cap_int, direction, &pkt_len, cap_src, cap_dst) < 5) {\n\n-    if (pkt_len > WTAP_MAX_PACKET_SIZE_STANDARD) {\n\n+    if (pkt_len < 0) {\n\n-        *err_info = g_strdup_printf(\"netscreen: File has %u-byte packet, bigger than maximum of %u\", pkt_len, WTAP_MAX_PACKET_SIZE_STANDARD);\n\n+        *err_info = g_strdup(\"netscreen: packet header has a negative packet length\");\n+        return FALSE;\n+    }\n+    if ((guint)pkt_len > WTAP_MAX_PACKET_SIZE_STANDARD) {\n+        *err = WTAP_ERR_BAD_FILE;\n+        *err_info = g_strdup_printf(\"netscreen: File has %u-byte packet, bigger than maximum of %u\", (guint)pkt_len, WTAP_MAX_PACKET_SIZE_STANDARD);\n\n-        n = parse_single_hex_dump_line(p, pd, offset, pkt_len);\n\n+        n = parse_single_hex_dump_line(p, pd, offset);\n\n-                if (n >= 0) {\n\n-        }\n-        if (n < 0) {\n-            switch (n) {\n-            case PARSE_LE_VALID_CHARACTER:\n-                *err = WTAP_ERR_BAD_FILE;\n-                *err_info = g_strdup(\"netscreen: invalid character in hex data\");\n-                break;\n-            case PARSE_LE_NO_BYTES_SEEN:\n-                *err = WTAP_ERR_BAD_FILE;\n-                *err_info = g_strdup(\"netscreen: no hex bytes seen in hex data\");\n-                break;\n-            case PARSE_LE_TOO_MANY_BYTES_SEEN:\n\n+        if (n == -1) {\n\n-                *err_info = g_strdup(\"netscreen: number of hex bytes seen in hex data is greater than the packet length\");\n-                break;\n-            default:\n-                *err = WTAP_ERR_TERNAL;\n-                *err_info = g_strdup_printf(\"netscreen: unknown error %d from parse_single_hex_dump_line()\", n);\n-                break;\n-            }\n\n+            *err_info = g_strdup(\"netscreen: cannot parse hex-data\");\n\n+        if (offset > pkt_len) {\n+            *err = WTAP_ERR_BAD_FILE;\n+            *err_info = g_strdup(\"netscreen: too much hex-data\");\n+            return FALSE;\n+        }\n\n",
    "4": "+                if (n >= 0) {\n\n",
    "5": "-                *err_info = g_strdup(\"netscreen: cannot parse hex-data\");\n\n+                    *err_info = g_strdup(\"netscreen: first line of packet data has only %d hex bytes, < 6\");\n\n-                    *err_info = g_strdup(\"netscreen: first line of packet data has only %d hex bytes, < 6\");\n\n+                *err_info = g_strdup(\"netscreen: cannot parse hex-data\");\n\n",
    "6": "-        if (n == -1) {\n-            *err = WTAP_ERR_BAD_FILE;\n-            *err_info = g_strdup(\"netscreen: cannot parse hex-data\");\n-            return FALSE;\n\n"
}