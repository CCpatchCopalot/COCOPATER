--- src/iperf_api.c
+++ src/iperf_api.c
@@ -2682,7 +2683,8 @@
     if (Nread(fd, (char*) &nsize, sizeof(nsize), Ptcp) >= 0) {
 	hsize = ntohl(nsize);
 	/* Allocate a buffer to hold the JSON */
-	str = (char *) calloc(sizeof(char), hsize+1);	/* +1 for trailing null */
+	strsize = hsize + 1;              /* +1 for trailing NULL */
+	if (strsize) {
 	str = (char *) calloc(sizeof(char), strsize);
 	if (str != NULL) {
 	    rc = Nread(fd, str, hsize, Ptcp);
@@ -2701,6 +2703,7 @@
 	    }
 	}
 	free(str);
+	}
 	}
     }
     return json;